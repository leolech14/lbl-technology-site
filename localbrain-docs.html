<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LocalBrain Documentation - Interactive Guide</title>
    <meta name="description" content="Interactive documentation for LocalBrain - Privacy-first AI command center for macOS">
    
    <!-- Preload fonts for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Marked.js for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        /* CSS Custom Properties - Matching main site theme */
        :root {
            /* Deep Blue/Navy Palette */
            --bg-primary: #0a0a0f;
            --bg-secondary: #0f1117;
            --bg-tertiary: #1a1a2e;
            
            /* Signature Blues */
            --blue-primary: #3b82f6;
            --blue-light: #60a5fa;
            --blue-dark: #1e40af;
            --blue-glow: rgba(59, 130, 246, 0.5);
            
            /* Orange Accent */
            --accent-orange: #f97316;
            --accent-orange-glow: rgba(249, 115, 22, 0.5);
            
            /* Glassmorphism */
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            
            /* Text Colors */
            --text-primary: #f0f0f0;
            --text-secondary: #a8a8b3;
            --text-muted: #6b7280;
            
            /* Spacing - Scaled to 75% */
            --space-xs: 0.375rem;
            --space-sm: 0.75rem;
            --space-md: 1.125rem;
            --space-lg: 1.5rem;
            --space-xl: 2.25rem;
            --space-2xl: 3rem;
            
            /* Animation */
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --hover-transform: translateY(-2px);
            
            /* Code Syntax Colors */
            --code-keyword: #ff79c6;
            --code-function: #8be9fd;
            --code-string: #f1fa8c;
            --code-number: #bd93f9;
            --code-comment: #6272a4;
            --code-variable: #50fa7b;
            --code-class: #ffb86c;
            --code-operator: #ff5555;
            --code-punctuation: #f8f8f2;
            --code-property: #66d9ef;
            --code-tag: #ff79c6;
            --code-attribute: #50fa7b;
        }
        
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            font-size: 14px; /* Base font size reduced from 16px */
        }
        
        /* Beautiful Gradient Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, var(--blue-glow) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, var(--accent-orange-glow) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, var(--blue-dark) 0%, transparent 50%);
            z-index: -2;
            opacity: 0.3;
        }
        
        /* Animated Background Orbs */
        .bg-orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.2;
            animation: float 20s infinite ease-in-out;
            z-index: -1;
        }
        
        .orb-1 {
            width: 600px;
            height: 600px;
            background: var(--blue-primary);
            top: -300px;
            left: -300px;
            animation-delay: 0s;
        }
        
        .orb-2 {
            width: 400px;
            height: 400px;
            background: var(--accent-orange);
            bottom: -200px;
            right: -200px;
            animation-delay: 5s;
        }
        
        @keyframes float {
            0%, 100% {
                transform: translate(0, 0) scale(1);
            }
            33% {
                transform: translate(30px, -30px) scale(1.1);
            }
            66% {
                transform: translate(-20px, 20px) scale(0.9);
            }
        }
        
        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            padding: var(--space-sm) var(--space-xl);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            height: 60px; /* Reduced from 80px */
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.125rem; /* Reduced from 1.5rem */
            font-weight: 700;
            background: linear-gradient(135deg, var(--blue-primary) 0%, var(--blue-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }
        
        .logo svg {
            width: 24px; /* Reduced from 32px */
            height: 24px;
        }
        
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-md);
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .back-button:hover {
            border-color: var(--blue-primary);
            color: var(--blue-light);
            transform: translateX(-2px);
        }
        
        /* Main Container */
        .container {
            max-width: 1200px; /* Reduced from 1400px */
            margin: 0 auto;
            padding: calc(60px + var(--space-xl)) var(--space-xl) var(--space-xl);
            display: grid;
            grid-template-columns: 210px 1fr; /* Reduced from 280px */
            gap: var(--space-xl);
            min-height: 100vh;
            overflow: hidden;
        }
        
        /* Sidebar Navigation */
        .sidebar {
            position: sticky;
            top: calc(80px + var(--space-xl));
            height: fit-content;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: var(--space-lg);
        }
        
        .nav-section {
            margin-bottom: var(--space-lg);
        }
        
        .nav-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--space-sm);
        }
        
        .nav-link {
            display: block;
            padding: var(--space-xs) var(--space-sm);
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 8px;
            transition: var(--transition);
            font-size: 0.875rem;
            margin-bottom: 0.25rem;
        }
        
        .nav-link:hover {
            background: var(--glass-bg);
            color: var(--blue-light);
            transform: translateX(4px);
        }
        
        .nav-link.active {
            background: rgba(59, 130, 246, 0.2);
            color: var(--blue-light);
            font-weight: 500;
        }
        
        /* Content Area */
        .content {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: var(--space-2xl);
            position: relative;
            overflow: hidden;
        }
        
        /* Tooltip System - Built from scratch */
        .tooltip {
            position: fixed;
            z-index: 999999;
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 8px;
            padding: 1rem;
            max-width: 450px;
            font-size: 0.75rem;
            line-height: 1.5;
            color: var(--text-primary);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .tooltip b {
            color: var(--primary-dark);
            font-weight: 600;
            display: inline-block;
        }
        
        .tooltip.visible {
            opacity: 1;
        }
        
        .tooltip-title {
            font-weight: 600;
            color: var(--blue-light);
            margin-bottom: 0.25rem;
        }
        
        .tooltip-content {
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        .tooltip-content strong {
            color: var(--text-primary);
        }
        
        /* Interactive elements */
        [data-tooltip] {
            cursor: help;
            border-bottom: 1px dotted var(--blue-primary);
        }
        
        /* Markdown Styles */
        .markdown-content {
            font-size: 0.875rem; /* Reduced from 1rem */
            line-height: 1.7;
        }
        
        .markdown-content h1 {
            font-size: 1.875rem; /* Reduced from 2.5rem */
            margin-bottom: var(--space-lg);
            background: linear-gradient(135deg, var(--blue-primary) 0%, var(--blue-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: inline-block;
        }
        
        .markdown-content h2 {
            font-size: 1.5rem; /* Reduced from 2rem */
            margin-top: var(--space-2xl);
            margin-bottom: var(--space-md);
            color: var(--text-primary);
            border-bottom: 1px solid var(--glass-border);
            padding-bottom: var(--space-sm);
        }
        
        .markdown-content h3 {
            font-size: 1.125rem; /* Reduced from 1.5rem */
            margin-top: var(--space-xl);
            margin-bottom: var(--space-sm);
            color: var(--blue-light);
        }
        
        .markdown-content p {
            margin-bottom: var(--space-md);
            color: var(--text-secondary);
        }
        
        .markdown-content ul, .markdown-content ol {
            margin-bottom: var(--space-md);
            padding-left: var(--space-lg);
        }
        
        .markdown-content li {
            margin-bottom: var(--space-xs);
            color: var(--text-secondary);
        }
        
        .markdown-content code {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-tertiary);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.75rem; /* Reduced for 75% scale */
            color: var(--blue-light);
        }
        
        
        .markdown-content pre {
            background: var(--bg-tertiary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: var(--space-md);
            overflow-x: auto;
            margin-bottom: var(--space-md);
            position: relative;
        }
        
        .markdown-content pre code {
            background: none;
            padding: 0;
            font-size: 0.75rem; /* Reduced for 75% scale */
            line-height: 1.6;
            color: var(--text-primary);
        }
        
        /* Syntax Highlighting Classes */
        .code-keyword { color: var(--code-keyword); font-weight: 600; }
        .code-function { color: var(--code-function); }
        .code-string { color: var(--code-string); }
        .code-number { color: var(--code-number); }
        .code-comment { color: var(--code-comment); font-style: italic; }
        .code-variable { color: var(--code-variable); }
        .code-class { color: var(--code-class); font-weight: 600; }
        .code-operator { color: var(--code-operator); }
        .code-punctuation { color: var(--code-punctuation); }
        .code-property { color: var(--code-property); }
        .code-tag { color: var(--code-tag); }
        .code-attribute { color: var(--code-attribute); }
        
        
        /* Interactive Elements */
        .interactive-term {
            position: relative;
            display: inline-block;
            border-bottom: 2px dotted var(--blue-primary);
            transition: var(--transition);
        }
        
        .interactive-term:hover {
            color: var(--blue-light);
            border-bottom-style: solid;
        }
        
        
        
        /* Tables */
        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--space-lg);
            overflow: hidden;
            border-radius: 12px;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
        }
        
        .markdown-content th {
            background: var(--bg-tertiary);
            padding: var(--space-sm) var(--space-md);
            text-align: left;
            font-weight: 600;
            color: var(--blue-light);
            border-bottom: 1px solid var(--glass-border);
        }
        
        .markdown-content td {
            padding: var(--space-sm) var(--space-md);
            border-bottom: 1px solid var(--glass-border);
            color: var(--text-secondary);
        }
        
        .markdown-content tr:last-child td {
            border-bottom: none;
        }
        
        .markdown-content tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
                padding-top: calc(60px + var(--space-md));
            }
            
            .sidebar {
                position: relative;
                top: 0;
                max-height: none;
                margin-bottom: var(--space-lg);
            }
            
            .content {
                padding: var(--space-xl);
            }
        }
        
        @media (max-width: 640px) {
            .header {
                padding: var(--space-sm) var(--space-md);
            }
            
            .content {
                padding: var(--space-md);
            }
            
            .markdown-content h1 {
                font-size: 2rem;
            }
            
            .markdown-content h2 {
                font-size: 1.5rem;
            }
            
        }
        
        /* Loading State */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 400px;
            font-size: 1.25rem;
            color: var(--text-muted);
        }
        
        /* Error State */
        .error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            padding: var(--space-lg);
            color: #ef4444;
            text-align: center;
        }
        
        /* Copy Button for Code Blocks */
        .copy-button {
            position: absolute;
            top: var(--space-sm);
            right: var(--space-sm);
            padding: 0.25rem 0.75rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            color: var(--text-muted);
            font-size: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .copy-button:hover {
            border-color: var(--blue-primary);
            color: var(--blue-light);
        }
        
        .copy-button.copied {
            color: #10b981;
            border-color: #10b981;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--blue-primary);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--blue-light);
        }
    </style>
</head>
<body>
    <!-- Animated Background Orbs -->
    <div class="bg-orb orb-1"></div>
    <div class="bg-orb orb-2"></div>
    
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"/>
                    <path d="M2 17l10 5 10-5M2 12l10 5 10-5"/>
                </svg>
                LocalBrain Documentation
            </div>
            <a href="index.html" class="back-button">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Back to Portfolio
            </a>
        </div>
    </header>
    
    <!-- Main Content -->
    <div class="container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <nav>
                <div class="nav-section">
                    <div class="nav-title">Overview</div>
                    <a href="#executive-summary" class="nav-link">Executive Summary</a>
                    <a href="#core-architecture-decisions" class="nav-link">Architecture</a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Features</div>
                    <a href="#1-voice-interaction-resolved" class="nav-link">Voice Interaction</a>
                    <a href="#2-terminal-implementation-resolved" class="nav-link">Terminal</a>
                    <a href="#3-uiux-specification-resolved" class="nav-link">UI/UX</a>
                    <a href="#4-file-system-security-resolved" class="nav-link">File System</a>
                    <a href="#5-llm-integration-resolved" class="nav-link">LLM Integration</a>
                    <a href="#6-plugin-system-simplified" class="nav-link">Plugin System</a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Implementation</div>
                    <a href="#implementation-sequence" class="nav-link">Phases</a>
                    <a href="#critical-implementation-details" class="nav-link">Code Examples</a>
                    <a href="#first-run-experience" class="nav-link">First Run</a>
                </div>
                
                <div class="nav-section">
                    <div class="nav-title">Deployment</div>
                    <a href="#build--distribution" class="nav-link">Build & Distribute</a>
                    <a href="#security--privacy" class="nav-link">Security</a>
                    <a href="#success-metrics" class="nav-link">Success Metrics</a>
                </div>
            </nav>
        </aside>
        
        <!-- Content Area -->
        <main class="content">
            <div id="markdown-content" class="markdown-content">
                <div class="loading">Loading documentation...</div>
            </div>
        </main>
    </div>
    
    <script>
        // Interactive terms dictionary
        const interactiveTerms = {
            'Electron': {
                title: 'Electron Framework',
                description: 'A framework for building cross-platform desktop apps with JavaScript, HTML, and CSS. It combines Chromium and Node.js into a single runtime.',
                connects: ['React', 'TypeScript', 'Node.js'],
                purpose: 'Enables web developers to create native desktop applications'
            },
            'pnpm workspaces': {
                title: 'PNPM Workspaces',
                description: 'A feature of pnpm that enables managing multiple packages in a single repository (monorepo). Faster and more efficient than npm or yarn.',
                connects: ['Package Manager', 'Monorepo'],
                purpose: 'Manages dependencies across multiple packages efficiently'
            },
            'React 18': {
                title: 'React 18',
                description: 'Latest version of React with concurrent features, automatic batching, and suspense improvements.',
                connects: ['TypeScript', 'Vite', 'UI Components'],
                purpose: 'Building interactive user interfaces with modern patterns'
            },
            'Vite': {
                title: 'Vite Build Tool',
                description: 'Next-generation frontend build tool that provides instant server start and lightning-fast HMR (Hot Module Replacement).',
                connects: ['React', 'TypeScript', 'Build System'],
                purpose: 'Extremely fast development server and optimized production builds'
            },
            'TypeScript': {
                title: 'TypeScript Language',
                description: 'A typed superset of JavaScript that compiles to plain JavaScript. Adds static types and modern features.',
                connects: ['React', 'Node.js', 'All Code'],
                purpose: 'Type safety, better IDE support, and fewer runtime errors'
            },
            'TailwindCSS': {
                title: 'Tailwind CSS',
                description: 'A utility-first CSS framework that provides low-level utility classes to build custom designs without leaving your HTML.',
                connects: ['React Components', 'UI Design'],
                purpose: 'Rapid UI development with consistent design system'
            },
            'OpenAI Whisper API': {
                title: 'Whisper Speech-to-Text',
                description: 'OpenAI\'s automatic speech recognition system, trained on 680,000 hours of multilingual data.',
                connects: ['Voice Input', 'LLM Integration'],
                purpose: 'Converts spoken words to text with high accuracy'
            },
            'OpenAI TTS API': {
                title: 'Text-to-Speech API',
                description: 'OpenAI\'s text-to-speech service that converts text into lifelike spoken audio.',
                connects: ['Voice Output', 'AI Responses'],
                purpose: 'Natural-sounding voice responses from the AI'
            },
            'OpenAI Chat API': {
                title: 'OpenAI Chat API',
                description: 'API for accessing OpenAI\'s language models like GPT-4 for chat completions and complex reasoning.',
                connects: ['Natural Language Processing', 'Command Execution'],
                purpose: 'Powers the AI brain of LocalBrain for understanding and executing commands'
            },
            'xterm.js': {
                title: 'Terminal Emulator',
                description: 'A terminal emulator written in JavaScript that works in the browser and Electron apps.',
                connects: ['Terminal Pane', 'Command Execution'],
                purpose: 'Provides a full-featured terminal interface in the app'
            },
            'Monaco Editor': {
                title: 'Monaco Code Editor',
                description: 'The code editor that powers VS Code, available as a standalone component.',
                connects: ['File Editing', 'Syntax Highlighting'],
                purpose: 'Professional code editing experience within LocalBrain'
            },
            'electron-store': {
                title: 'Electron Store',
                description: 'Simple data persistence for Electron apps - like localStorage for Node.js.',
                connects: ['Settings', 'Configuration'],
                purpose: 'Persists user preferences and app settings'
            },
            'electron-builder': {
                title: 'Electron Builder',
                description: 'A complete solution to package and build ready-for-distribution Electron apps.',
                connects: ['DMG Creation', 'App Distribution'],
                purpose: 'Creates installable packages for macOS'
            },
            'Web Audio API': {
                title: 'Web Audio API',
                description: 'High-level JavaScript API for processing and synthesizing audio in web applications.',
                connects: ['Voice Capture', 'Audio Processing'],
                purpose: 'Captures microphone input and processes audio streams'
            },
            'child_process': {
                title: 'Node Child Process',
                description: 'Node.js module that provides the ability to spawn child processes.',
                connects: ['Terminal', 'Command Execution'],
                purpose: 'Executes system commands without complex dependencies'
            },
            'Glassmorphism': {
                title: 'Glassmorphism Design',
                description: 'A design trend that uses transparency, blur effects, and subtle borders to create a glass-like appearance.',
                connects: ['UI Design', 'Visual Effects'],
                purpose: 'Creates modern, premium-looking user interfaces'
            },
            'VAD': {
                title: 'Voice Activity Detection',
                description: 'Technology that detects when human speech is present in an audio signal.',
                connects: ['Voice Input', 'Audio Processing'],
                purpose: 'Automatically detects when the user starts/stops speaking'
            },
            'RMS': {
                title: 'Root Mean Square',
                description: 'A statistical measure used in audio processing to determine the average power of a signal.',
                connects: ['VAD', 'Audio Analysis'],
                purpose: 'Simple method to detect voice activity levels'
            },
            'DMG': {
                title: 'Disk Image (macOS)',
                description: 'Apple Disk Image format used for distributing macOS applications.',
                connects: ['App Distribution', 'macOS'],
                purpose: 'Standard way to distribute macOS apps outside the App Store'
            },
            'HMR': {
                title: 'Hot Module Replacement',
                description: 'Updates modules in the browser while an application is running, without a full page reload.',
                connects: ['Vite', 'Development'],
                purpose: 'Instant feedback during development'
            },
            'STT': {
                title: 'Speech-to-Text',
                description: 'Technology that converts spoken language into written text.',
                connects: ['Whisper API', 'Voice Input'],
                purpose: 'Enables voice commands and dictation'
            },
            'TTS': {
                title: 'Text-to-Speech',
                description: 'Technology that converts written text into spoken words.',
                connects: ['OpenAI TTS', 'Voice Output'],
                purpose: 'Allows the AI to speak responses'
            },
            'LLM': {
                title: 'Large Language Model',
                description: 'AI models trained on vast amounts of text data that can understand and generate human-like text.',
                connects: ['OpenAI API', 'Natural Language'],
                purpose: 'The AI brain that understands and responds to commands'
            },
            'PTY': {
                title: 'Pseudo Terminal',
                description: 'A pair of virtual character devices that provide a bidirectional communication channel.',
                connects: ['Terminal', 'Process Management'],
                purpose: 'Full terminal emulation (avoided in LocalBrain for simplicity)'
            },
            'API Key': {
                title: 'API Key',
                description: 'A unique identifier used to authenticate requests to an API service.',
                connects: ['OpenAI', 'Authentication'],
                purpose: 'Securely connects LocalBrain to OpenAI services'
            },
            'Monorepo': {
                title: 'Monorepo Structure',
                description: 'A repository that contains multiple projects or packages, managed as a single unit.',
                connects: ['pnpm workspaces', 'Project Structure'],
                purpose: 'Organizes code into logical, reusable packages'
            },
            'model=\'o3\'': {
                title: 'O3 Model',
                description: 'Advanced OpenAI model optimized for complex reasoning and task completion.',
                connects: ['LLM', 'AI Capabilities'],
                purpose: 'Provides superior reasoning for complex commands'
            },
            'alloy': {
                title: 'Alloy Voice',
                description: 'One of OpenAI\'s TTS voices, known for its natural and pleasant sound.',
                connects: ['TTS', 'Voice Output'],
                purpose: 'Default voice for AI responses'
            },
            'Hey LocalBrain': {
                title: 'Wake Word',
                description: 'A phrase that activates the voice assistant, similar to "Hey Siri" or "OK Google".',
                connects: ['Voice Activation', 'Always Listening'],
                purpose: 'Hands-free activation of voice commands'
            },
            'Electron 28': {
                title: 'Electron Version 28',
                description: 'The latest stable version of Electron with improved performance, security updates, and better macOS support.',
                connects: ['Chromium', 'Node.js', 'V8 Engine'],
                purpose: 'Provides the most up-to-date features and security patches'
            },
            'node-pty': {
                title: 'Node PTY',
                description: 'Node.js bindings for pseudo terminals (PTY). Requires C++ compilation and platform-specific builds.',
                connects: ['Terminal', 'PTY', 'xterm.js'],
                purpose: 'Full terminal emulation (avoided in LocalBrain for simplicity)'
            },
            'bootstrap': {
                title: 'Bootstrap (LLM Context)',
                description: 'The initial setup phase of an LLM conversation where system context, capabilities, and constraints are established.',
                connects: ['System Prompt', 'Context Injection', 'LLM'],
                purpose: 'Primes the AI with necessary information for accurate responses'
            },
            'package.json': {
                title: 'Package.json File',
                description: 'The manifest file for Node.js projects that defines dependencies, scripts, metadata, and project configuration.',
                connects: ['npm', 'pnpm', 'Node.js'],
                purpose: 'Central configuration for JavaScript/TypeScript projects'
            },
            '.env.example': {
                title: 'Environment Example File',
                description: 'A template file showing required environment variables without exposing actual secrets. Safe to commit to version control.',
                connects: ['.env', 'Security', 'Configuration'],
                purpose: 'Documents required environment variables while keeping secrets safe'
            }
        };
        
        // Comprehensive code syntax dictionary
        const codeSyntaxDictionary = {
            // JavaScript/TypeScript Keywords
            'const': {
                type: 'keyword',
                title: 'const Declaration',
                description: 'Declares a constant variable that cannot be reassigned. The value itself may still be mutable (for objects/arrays).',
                example: 'const PI = 3.14159; // Cannot do PI = 3.14',
                details: 'Block-scoped, temporal dead zone applies, must be initialized at declaration.'
            },
            'let': {
                type: 'keyword',
                title: 'let Declaration',
                description: 'Declares a block-scoped variable that can be reassigned.',
                example: 'let count = 0; count = count + 1;',
                details: 'Replaces var in modern JavaScript. No hoisting to function scope.'
            },
            'var': {
                type: 'keyword',
                title: 'var Declaration',
                description: 'Legacy variable declaration. Function-scoped or globally-scoped.',
                example: 'var oldStyle = "avoid in modern code";',
                details: 'Hoisted to top of function, can cause unexpected behavior. Use let/const instead.'
            },
            'function': {
                type: 'keyword',
                title: 'Function Declaration',
                description: 'Declares a named function that can be called elsewhere.',
                example: 'function greet(name) { return `Hello ${name}`; }',
                details: 'Hoisted to top of scope, can be called before declaration.'
            },
            'async': {
                type: 'keyword',
                title: 'Async Function',
                description: 'Declares an asynchronous function that returns a Promise.',
                example: 'async function fetchData() { const result = await api.get(); }',
                details: 'Allows use of await keyword inside. Always returns a Promise.'
            },
            'await': {
                type: 'keyword',
                title: 'Await Expression',
                description: 'Pauses async function execution until Promise resolves.',
                example: 'const data = await fetch(url);',
                details: 'Only valid inside async functions. Makes async code look synchronous.'
            },
            'class': {
                type: 'keyword',
                title: 'Class Declaration',
                description: 'Declares a class for object-oriented programming.',
                example: 'class Animal { constructor(name) { this.name = name; } }',
                details: 'Syntactic sugar over prototype-based inheritance. Supports extends, super, static.'
            },
            'interface': {
                type: 'keyword',
                title: 'TypeScript Interface',
                description: 'Defines the shape of an object in TypeScript.',
                example: 'interface User { name: string; age: number; }',
                details: 'Only exists at compile time. Can be extended and implemented by classes.'
            },
            'import': {
                type: 'keyword',
                title: 'ES6 Import',
                description: 'Imports functionality from other modules.',
                example: 'import { Component } from "react";',
                details: 'ES6 module syntax. Can import default exports, named exports, or entire modules.'
            },
            'export': {
                type: 'keyword',
                title: 'ES6 Export',
                description: 'Exports functionality for use in other modules.',
                example: 'export const API_KEY = "secret";',
                details: 'Can export named items, default export, or re-export from other modules.'
            },
            'return': {
                type: 'keyword',
                title: 'Return Statement',
                description: 'Exits function and optionally returns a value.',
                example: 'return result * 2;',
                details: 'If no value specified, returns undefined. Stops function execution immediately.'
            },
            'if': {
                type: 'keyword',
                title: 'If Statement',
                description: 'Conditional execution based on boolean expression.',
                example: 'if (condition) { doSomething(); }',
                details: 'Can be chained with else if and else. Condition is coerced to boolean.'
            },
            'for': {
                type: 'keyword',
                title: 'For Loop',
                description: 'Iterates a specified number of times.',
                example: 'for (let i = 0; i < 10; i++) { }',
                details: 'Three parts: initialization, condition, increment. All are optional.'
            },
            'try': {
                type: 'keyword',
                title: 'Try Block',
                description: 'Attempts to execute code that might throw an error.',
                example: 'try { riskyOperation(); } catch (e) { }',
                details: 'Must be followed by catch and/or finally. Catches synchronous errors only.'
            },
            // Operators
            '=>': {
                type: 'operator',
                title: 'Arrow Function',
                description: 'Concise syntax for function expressions.',
                example: 'const double = x => x * 2;',
                details: 'Lexically binds this. No arguments object. Cannot be used as constructor.'
            },
            '===': {
                type: 'operator',
                title: 'Strict Equality',
                description: 'Compares value and type without coercion.',
                example: '5 === "5" // false',
                details: 'Preferred over == in most cases. NaN !== NaN is the odd case.'
            },
            '...': {
                type: 'operator',
                title: 'Spread/Rest Operator',
                description: 'Expands iterables or collects remaining arguments.',
                example: 'const arr2 = [...arr1, 4, 5]; function sum(...nums) { }',
                details: 'In arrays: spreads elements. In functions: collects arguments. In objects: shallow copy.'
            },
            '?.': {
                type: 'operator',
                title: 'Optional Chaining',
                description: 'Safely access nested properties that might not exist.',
                example: 'const city = user?.address?.city;',
                details: 'Returns undefined if any part is null/undefined. Short-circuits evaluation.'
            },
            '??': {
                type: 'operator',
                title: 'Nullish Coalescing',
                description: 'Returns right side only if left is null or undefined.',
                example: 'const port = process.env.PORT ?? 3000;',
                details: 'Unlike ||, treats 0, "", false as valid values. Only null/undefined trigger fallback.'
            },
            // Common Functions/Methods
            'useState': {
                type: 'function',
                title: 'React useState Hook',
                description: 'Adds state to functional components.',
                example: 'const [count, setCount] = useState(0);',
                details: 'Returns array: [currentValue, setterFunction]. Triggers re-render on state change.'
            },
            'useEffect': {
                type: 'function',
                title: 'React useEffect Hook',
                description: 'Handles side effects in functional components.',
                example: 'useEffect(() => { fetchData(); }, [dependency]);',
                details: 'Runs after render. Cleanup function optional. Dependencies control when it runs.'
            },
            'addEventListener': {
                type: 'function',
                title: 'DOM Event Listener',
                description: 'Attaches event handler to DOM element.',
                example: 'element.addEventListener("click", handleClick);',
                details: 'Third parameter for options/useCapture. Remember to removeEventListener when done.'
            },
            'querySelector': {
                type: 'function',
                title: 'DOM Query Selector',
                description: 'Finds first element matching CSS selector.',
                example: 'document.querySelector(".my-class");',
                details: 'Returns null if not found. Use querySelectorAll for multiple elements.'
            },
            'map': {
                type: 'function',
                title: 'Array Map Method',
                description: 'Creates new array by transforming each element.',
                example: '[1, 2, 3].map(x => x * 2); // [2, 4, 6]',
                details: 'Does not mutate original array. Returns array of same length. Skip elements with return undefined.'
            },
            'filter': {
                type: 'function',
                title: 'Array Filter Method',
                description: 'Creates new array with elements that pass test.',
                example: '[1, 2, 3, 4].filter(x => x > 2); // [3, 4]',
                details: 'Does not mutate original. Callback should return boolean. Empty array if none pass.'
            },
            'reduce': {
                type: 'function',
                title: 'Array Reduce Method',
                description: 'Reduces array to single value using accumulator.',
                example: '[1, 2, 3].reduce((sum, x) => sum + x, 0); // 6',
                details: 'Most versatile array method. Can implement map/filter/etc. Initial value recommended.'
            },
            // Types
            'string': {
                type: 'type',
                title: 'String Type',
                description: 'Text data type for characters and words.',
                example: 'const name: string = "Alice";',
                details: 'Immutable in JavaScript. Template literals with backticks support interpolation.'
            },
            'number': {
                type: 'type',
                title: 'Number Type',
                description: 'Numeric data type for integers and floats.',
                example: 'const age: number = 25; const pi: number = 3.14;',
                details: 'All numbers are floating point. Special values: Infinity, -Infinity, NaN.'
            },
            'boolean': {
                type: 'type',
                title: 'Boolean Type',
                description: 'True or false logical values.',
                example: 'const isActive: boolean = true;',
                details: 'Falsy values: false, 0, "", null, undefined, NaN. Everything else is truthy.'
            },
            'void': {
                type: 'type',
                title: 'Void Type',
                description: 'Function returns no value (TypeScript).',
                example: 'function log(msg: string): void { console.log(msg); }',
                details: 'Different from undefined. Used for functions with no return statement.'
            },
            'Promise': {
                type: 'type',
                title: 'Promise Type',
                description: 'Represents eventual completion of async operation.',
                example: 'function fetchUser(): Promise<User> { }',
                details: 'Three states: pending, fulfilled, rejected. Chain with then/catch/finally.'
            },
            // Special values
            'null': {
                type: 'value',
                title: 'Null Value',
                description: 'Intentional absence of any object value.',
                example: 'let data = null; // explicitly empty',
                details: 'typeof null === "object" (historic bug). Different from undefined.'
            },
            'undefined': {
                type: 'value',
                title: 'Undefined Value',
                description: 'Variable declared but not assigned.',
                example: 'let x; console.log(x); // undefined',
                details: 'Default return value. Property that doesn\'t exist. Different from null.'
            },
            'true': {
                type: 'value',
                title: 'Boolean True',
                description: 'Boolean literal representing logical true.',
                example: 'const isEnabled = true;',
                details: 'Lowercase only. In conditions, many values are "truthy" but not === true.'
            },
            'false': {
                type: 'value',
                title: 'Boolean False',
                description: 'Boolean literal representing logical false.',
                example: 'const isDisabled = false;',
                details: 'Lowercase only. One of the falsy values in JavaScript.'
            }
        };
        
        // Load and process markdown content from embedded string
        // Helper function to escape HTML attributes
        function escapeHtmlAttribute(text) {
            return text
                .replace(/&/g, '&amp;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');
        }
        
        async function loadMarkdown() {
            try {
                // Use the embedded markdown content
                const text = markdownContent;
                
                // Parse markdown
                const html = marked.parse(text);
                
                // Add interactive elements
                const interactiveHtml = addInteractiveElements(html);
                
                // Display content
                document.getElementById('markdown-content').innerHTML = interactiveHtml;
                
                // Add copy buttons to code blocks
                addCopyButtons();
                
                // Setup navigation
                setupNavigation();
                
                
                // Apply syntax highlighting to code blocks
                applySyntaxHighlighting();
                
            } catch (error) {
                document.getElementById('markdown-content').innerHTML = `
                    <div class="error">
                        <h2>Error Loading Documentation</h2>
                        <p>Unable to process the documentation. Please try refreshing the page.</p>
                        <p>Error: ${error.message}</p>
                    </div>
                `;
            }
        }
        
        // Add interactive elements to specific terms
        function addInteractiveElements(html) {
            // First, temporarily replace code blocks and pre elements to protect them
            const codeBlocks = [];
            const preBlocks = [];
            
            // Store and replace <code> blocks
            html = html.replace(/<code[^>]*>[\s\S]*?<\/code>/g, (match) => {
                const placeholder = `___CODE_BLOCK_${codeBlocks.length}___`;
                codeBlocks.push(match);
                return placeholder;
            });
            
            // Store and replace <pre> blocks
            html = html.replace(/<pre[^>]*>[\s\S]*?<\/pre>/g, (match) => {
                const placeholder = `___PRE_BLOCK_${preBlocks.length}___`;
                preBlocks.push(match);
                return placeholder;
            });
            
            let processedHtml = html;
            
            // Sort terms by length (longest first) to avoid partial matches
            const sortedTerms = Object.keys(interactiveTerms).sort((a, b) => b.length - a.length);
            
            sortedTerms.forEach(term => {
                const info = interactiveTerms[term];
                // Simple word boundary regex now that code is protected
                const regex = new RegExp(`\\b(${escapeRegex(term)})\\b`, 'g');
                
                processedHtml = processedHtml.replace(regex, (match, p1, offset, string) => {
                    // Check if we're inside an HTML tag
                    const beforeMatch = string.substring(0, offset);
                    const lastOpenTag = beforeMatch.lastIndexOf('<');
                    const lastCloseTag = beforeMatch.lastIndexOf('>');
                    
                    if (lastOpenTag > lastCloseTag) {
                        // We're inside a tag, don't wrap
                        return match;
                    }
                    
                    // Check if we're already inside an interactive-term
                    const openTerms = (beforeMatch.match(/<span class="interactive-term"/g) || []).length;
                    const closeTerms = (beforeMatch.match(/<\/span>/g) || []).length;
                    
                    if (openTerms > closeTerms) {
                        // Already wrapped, don't wrap again
                        return match;
                    }
                    
                    
                    return `<span class="interactive-term" data-tooltip="${escapeHtmlAttribute(info.description)}">
                        ${match}
                    </span>`;
                });
            });
            
            // Restore pre blocks
            preBlocks.forEach((block, index) => {
                processedHtml = processedHtml.replace(`___PRE_BLOCK_${index}___`, block);
            });
            
            // Restore code blocks
            codeBlocks.forEach((block, index) => {
                processedHtml = processedHtml.replace(`___CODE_BLOCK_${index}___`, block);
            });
            
            return processedHtml;
        }
        
        // Escape regex special characters
        function escapeRegex(str) {
            return str.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }
        
        // Add copy buttons to code blocks
        function addCopyButtons() {
            const codeBlocks = document.querySelectorAll('pre');
            
            codeBlocks.forEach(block => {
                const button = document.createElement('button');
                button.className = 'copy-button';
                button.textContent = 'Copy';
                
                button.addEventListener('click', async () => {
                    const code = block.querySelector('code').textContent;
                    try {
                        await navigator.clipboard.writeText(code);
                        button.textContent = 'Copied!';
                        button.classList.add('copied');
                        
                        setTimeout(() => {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    } catch (err) {
                        console.error('Failed to copy:', err);
                    }
                });
                
                block.appendChild(button);
            });
        }
        
        // Setup smooth scrolling navigation
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('h2, h3');
            
            // Smooth scroll on click
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const target = document.getElementById(targetId);
                    
                    if (target) {
                        const headerHeight = 100;
                        const targetPosition = target.offsetTop - headerHeight;
                        
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Update active link on scroll
            const observerOptions = {
                rootMargin: '-100px 0px -70% 0px',
                threshold: 0
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${id}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);
            
            sections.forEach(section => {
                if (section.id) {
                    observer.observe(section);
                }
            });
        }
        
        // Make the file content available for the script
        const markdownContent = `#  LocalBrain v0.1 - Unified Build Specification

## Executive Summary
LocalBrain is a privacy-first, AI-powered local environment command center for macOS that bridges natural language interaction with system control. This unified specification resolves all conflicts from previous prompts and provides a single, coherent implementation path.

## Core Architecture Decisions

### Technology Stack (Final)
| Component | Technology | Rationale |
|-----------|------------|-----------|
| Desktop Framework | **Electron 28** | Latest stable with good macOS support |
| Package Manager | **pnpm workspaces** | Better monorepo support, faster installs |
| Frontend | **React 18 + Vite + TypeScript + TailwindCSS** | Modern, fast, type-safe |
| Voice STT | **OpenAI Whisper API** | Best accuracy, no local models needed |
| Voice TTS | **OpenAI TTS API** | Consistent quality, "alloy" voice default |
| LLM | **OpenAI Chat API (model='o3')** | Excel at complex reasoning tasks |
| Terminal | **xterm.js + custom PTY wrapper** | Avoids node-pty compilation issues |
| File System | **Node fs with allowed roots** | Security through restriction |
| State | **electron-store** | Simple, reliable persistence |
| Editor | **Monaco Editor (read-only default)** | VSCode's editor, feature-rich |
| Build | **electron-builder  unsigned DMG** | Standard for Electron apps |

### Project Structure (Final)
\`\`\`
localbrain/
 package.json                 # Root workspace config
 pnpm-workspace.yaml         # Workspace definitions
 .env.example                # Environment template
 scripts/
    make-icons.js          # Icon generation utility
 apps/
    desktop/               # Electron application
        package.json
        electron-builder.yml
        build/             # Build resources (icons, etc)
        src/
            main/          # Main process
            preload/       # Preload scripts
            renderer/      # React application
                components/
                   ChatPane.tsx
                   TerminalPane.tsx
                   PreviewPane.tsx
                   FileExplorerPane.tsx
                   FirstRunWizard.tsx
                hooks/
                utils/
                App.tsx
 packages/
    core/                  # Core business logic
       src/
           agent.ts       # LLM orchestrator
           audio.ts       # Voice services
           terminal.ts    # Terminal management
           filesystem.ts  # File operations
    ui/                    # Shared UI components
       src/
           Button.tsx
           Input.tsx
           Modal.tsx
    types/                 # Shared TypeScript types
 plugins/                   # Plugin system
     example-plugin/
         manifest.json
         index.js
\`\`\`

## Unified Feature Specifications

### 1. Voice Interaction (Resolved)
- **Wake Word**: "Hey LocalBrain" (case-insensitive)
- **Sleep Command**: "Go to sleep" or "Goodbye"
- **Implementation**: Web Audio API in renderer process
- **Modes**:
  - **Chain Mode**: Record  Process  Respond
  - **Realtime Mode**: Streaming transcription (future)
- **Voice Activity Detection**: Client-side RMS threshold
- **Default TTS Voice**: "alloy" (most natural sounding)

### 2. Terminal Implementation (Resolved)
- **Frontend**: xterm.js for rendering
- **Backend**: Custom PTY wrapper using Node.js child_process
- **Features**:
  - Multiple tabs
  - Command queue with visual status
  - Output streaming to LLM for context
  - Claude CLI integration via command injection
- **No node-pty**: Avoids compilation issues

### 3. UI/UX Specification (Resolved)
\`\`\`

  Chat/Voice             Preview/Editor     
  Messages with MD        Monaco (readonly)  
  Voice indicator         Image viewer       
  File attachments        HTML preview       
  Status badges           Markdown render    

  Terminal               File Explorer      
  Multi-tab              Tree view          
  Command queue          Allowed roots only 
  Status indicators      Drag & drop        


Top Bar: Logo | Mode: [Chain|Realtime] | Model: [gpt-4o-mini] |  Awake
\`\`\`

### 4. File System Security (Resolved)
- **Allowed Roots**: User must explicitly grant folder access
- **Default**: ~/Documents/LocalBrain (created on first run)
- **Storage**: ~/.localbrain/config.json
- **Restrictions**: No access outside allowed roots
- **File Operations**: Read, write (with diff preview), watch

### 5. LLM Integration (Resolved)
\`\`\`typescript
interface AgentCapabilities {
  // Core functions exposed to LLM
  runCommand(cmd: string, cwd?: string): Promise<string>;
  readFile(path: string): Promise<string>;
  writeFile(path: string, content: string): Promise<void>;
  listFiles(dir: string): Promise<FileInfo[]>;
  speak(text: string): Promise<void>;
}
\`\`\`

### 6. Plugin System (Simplified)
\`\`\`javascript
// manifest.json
{
  "id": "example-plugin",
  "name": "Example Plugin",
  "version": "1.0.0",
  "main": "index.js"
}

// index.js
module.exports = {
  activate(context) {
    // Register commands, UI elements, etc
    context.registerCommand('example:hello', () => {
      context.showMessage('Hello from plugin!');
    });
  },
  deactivate() {
    // Cleanup
  }
};
\`\`\`

## Implementation Sequence

### Phase 1: Foundation (Day 1-2)
1. Set up pnpm workspace structure
2. Create Electron shell with TypeScript
3. Implement basic 4-pane layout with react-split
4. Dark theme with TailwindCSS

### Phase 2: Core Features (Day 3-4)
1. Terminal implementation with xterm.js
2. File explorer with electron's dialog API
3. Monaco editor integration
4. Basic chat interface

### Phase 3: AI Integration (Day 5-6)
1. OpenAI client setup
2. Voice capture with Web Audio API
3. STT/TTS implementation
4. Command execution pipeline

### Phase 4: Polish & Package (Day 7)
1. First-run wizard
2. Settings persistence
3. Icon generation
4. DMG packaging

## Critical Implementation Details

### Terminal Without node-pty
\`\`\`typescript
import { spawn } from 'child_process';

class Terminal {
  private process: ChildProcess;
  
  constructor() {
    this.process = spawn(process.env.SHELL || '/bin/zsh', [], {
      env: process.env,
      cwd: process.cwd()
    });
  }
  
  write(data: string) {
    this.process.stdin.write(data);
  }
  
  onData(callback: (data: string) => void) {
    this.process.stdout.on('data', callback);
    this.process.stderr.on('data', callback);
  }
}
\`\`\`

### Voice Capture
\`\`\`typescript
class VoiceCapture {
  private mediaRecorder: MediaRecorder;
  private audioContext: AudioContext;
  
  async startListening() {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    this.audioContext = new AudioContext();
    const source = this.audioContext.createMediaStreamSource(stream);
    
    // Simple VAD with RMS
    const analyser = this.audioContext.createAnalyser();
    source.connect(analyser);
    
    this.mediaRecorder = new MediaRecorder(stream);
    this.mediaRecorder.start();
  }
}
\`\`\`

### Settings Storage
\`\`\`typescript
// Using electron-store for all settings
const store = new Store({
  schema: {
    openaiApiKey: { type: 'string' },
    allowedRoots: { type: 'array', items: { type: 'string' } },
    voice: {
      type: 'object',
      properties: {
        enabled: { type: 'boolean', default: true },
        wakeWord: { type: 'string', default: 'hey localbrain' },
        ttsVoice: { type: 'string', default: 'alloy' }
      }
    }
  }
});
\`\`\`

## First Run Experience

1. **Welcome Screen**
   - Brief explanation of LocalBrain
   - Privacy assurance (local-first)

2. **API Key Setup**
   - OpenAI API key input
   - Test connection button

3. **Folder Access**
   - Select allowed folders
   - Default to ~/Documents/LocalBrain

4. **Voice Setup** (Optional)
   - Test microphone
   - Practice wake word

## Security & Privacy

- **No Telemetry**: Zero tracking or analytics
- **Local Storage**: All data stays on device
- **Network**: Only OpenAI API calls
- **File Access**: Explicit user permission required
- **Command Safety**: Confirmation for destructive operations

## Build & Distribution

### Development
\`\`\`bash
# Install dependencies
pnpm install

# Start development
pnpm dev

# Run tests
pnpm test
\`\`\`

### Production Build
\`\`\`bash
# Build all packages
pnpm build

# Generate icons (requires 1024x1024 PNG)
pnpm icons

# Create DMG
pnpm dist:mac
\`\`\`

### Distribution Requirements
- Unsigned DMG (users right-click  Open)
- Future: Apple Developer ID for signing
- Size target: < 150MB

## Success Metrics

The application is complete when:
-  Wake word activates voice listening
-  Natural language commands execute in terminal
-  Files can be read/edited through chat
-  All 4 panes are functional and resizable
-  Settings persist between sessions
-  DMG installs cleanly on macOS 12+

## Known Limitations & Future Work

### Current Limitations
- Terminal is basic (no full PTY features)
- Voice is English-only
- No multi-user support
- No cloud sync

### Future Enhancements
- Real-time voice mode
- Multiple LLM providers
- Plugin marketplace
- Windows/Linux support
- Local LLM option

---

**This is the definitive specification for LocalBrain v0.1. All implementation decisions are final and tested for compatibility.**

##  Technology Deep Dive

### Electron 28

**What is Electron?**
Electron is a framework that lets you build cross-platform desktop applications using web technologies (HTML, CSS, JavaScript). Think of it as a specialized web browser that runs your app.

**Architecture:**
\`\`\`

          Electron Application           

   Main Process     Renderer Process    
  (Node.js env)    (Chromium browser)   
                                        
  App lifecycle   UI rendering        
  Native APIs     React components    
  File system     User interaction    
  IPC handler     Web APIs            

\`\`\`

**Why Electron for LocalBrain?**
- **Native APIs**: Access file system, terminal, system notifications
- **Web Tech**: Use familiar React/TypeScript stack
- **Cross-platform**: Same codebase for macOS, Windows, Linux
- **Rich ecosystem**: Tons of plugins and tools

**Alternatives considered:**
- **Tauri**: Smaller bundles but less mature ecosystem
- **Native development**: Too time-consuming for rapid iteration
- **Flutter Desktop**: Less suited for developer tools

**Example usage in LocalBrain:**
\`\`\`javascript
// main/index.ts - Main process
import { app, BrowserWindow, ipcMain } from 'electron';

// Create the application window
const createWindow = () => {
  const mainWindow = new BrowserWindow({
    width: 1400,
    height: 900,
    webPreferences: {
      preload: path.join(__dirname, 'preload.js')
    }
  });
  
  mainWindow.loadFile('index.html');
};

app.whenReady().then(createWindow);
\`\`\`

### pnpm (vs npm)

**What is pnpm?**
pnpm is a fast, disk space-efficient package manager for JavaScript. It's an alternative to npm and yarn.

**How it works differently:**
\`\`\`
Traditional npm:
project1/node_modules/react (10MB)
project2/node_modules/react (10MB)  Duplicate!
project3/node_modules/react (10MB)  Duplicate!

pnpm with content-addressable storage:
~/.pnpm-store/
   react@18.0.0 (10MB)  Single copy!
  
project1/node_modules/react  symlink
project2/node_modules/react  symlink  
project3/node_modules/react  symlink
\`\`\`

**Benefits for LocalBrain:**
- **Monorepo support**: Perfect for our multi-package structure
- **Faster installs**: Up to 2x faster than npm
- **Disk efficiency**: Saves gigabytes with many projects
- **Strict by default**: Prevents phantom dependencies

**pnpm workspace example:**
\`\`\`yaml
# pnpm-workspace.yaml
packages:
  - 'apps/*'
  - 'packages/*'
  - 'plugins/*'
\`\`\`

### React 18

**What's new in React 18?**
- **Concurrent features**: Better performance for complex UIs
- **Automatic batching**: Groups state updates intelligently
- **Suspense improvements**: Better async data handling
- **New hooks**: useId, useSyncExternalStore, etc.

**How LocalBrain uses React 18:**
\`\`\`tsx
// Concurrent rendering for smooth voice feedback
function ChatPane() {
  const [messages, setMessages] = useState([]);
  const [isListening, setIsListening] = useState(false);
  
  // Automatic batching groups these updates
  const handleVoiceCommand = () => {
    setIsListening(true);
    setMessages(prev => [...prev, { type: 'user', text: '...' }]);
    // Both state updates happen in one render!
  };
  
  return (
    <div className="chat-pane">
      <TransitionGroup>
        {messages.map(msg => (
          <CSSTransition key={msg.id} timeout={300}>
            <Message {...msg} />
          </CSSTransition>
        ))}
      </TransitionGroup>
    </div>
  );
}
\`\`\`

### Vite

**What is Vite?**
Vite (French for "quick") is a build tool that provides lightning-fast development experience.

**Traditional bundlers vs Vite:**
\`\`\`
Webpack/Traditional:
1. Bundle EVERYTHING on start
2. Rebuild entire bundle on change
3. Slow initial start (10-30s)

Vite:
1. Serve native ES modules
2. Transform only what's requested  
3. Instant server start (<300ms)
\`\`\`

**Vite config for LocalBrain:**
\`\`\`typescript
// vite.config.ts
export default defineConfig({
  plugins: [react()],
  server: {
    port: 3000
  },
  build: {
    // Optimize for Electron
    target: 'esnext',
    minify: 'esbuild'
  }
});
\`\`\`

### TypeScript

**Why TypeScript?**
\`\`\`typescript
// Without TypeScript - Runtime errors!
function processCommand(cmd) {
  return cmd.toLowercase(); //  Bug! It's toLowerCase()
}

// With TypeScript - Caught at compile time
function processCommand(cmd: string): string {
  return cmd.toLowerCase(); //  IDE shows the correct method
}
\`\`\`

**LocalBrain type examples:**
\`\`\`typescript
interface VoiceCommand {
  id: string;
  timestamp: Date;
  rawAudio: ArrayBuffer;
  transcription?: string;
  confidence?: number;
}

interface LLMResponse {
  command?: SystemCommand;
  explanation: string;
  requiresConfirmation: boolean;
}

type SystemCommand = 
  | { type: 'terminal'; cmd: string; cwd?: string }
  | { type: 'file'; action: 'read' | 'write'; path: string }
  | { type: 'speak'; text: string; voice?: string };
\`\`\`

### TailwindCSS

**What is Tailwind?**
Utility-first CSS framework - instead of writing custom CSS, you compose designs using utility classes.

**Traditional CSS vs Tailwind:**
\`\`\`css
/* Traditional CSS */
.chat-message {
  padding: 1rem;
  margin-bottom: 0.5rem;
  background-color: rgba(59, 130, 246, 0.1);
  border-radius: 0.5rem;
  border: 1px solid rgba(59, 130, 246, 0.3);
}

/* Tailwind - Same styling */
<div className="p-4 mb-2 bg-blue-500/10 rounded-lg border border-blue-500/30">
\`\`\`

**LocalBrain's dark theme with Tailwind:**
\`\`\`tsx
// Glassmorphism effect
<div className="backdrop-blur-xl bg-white/5 border border-white/10 rounded-2xl p-6 shadow-2xl">
  <h2 className="text-2xl font-bold bg-gradient-to-r from-blue-500 to-blue-300 bg-clip-text text-transparent">
    LocalBrain
  </h2>
</div>
\`\`\`

### xterm.js

**What is xterm.js?**
A terminal emulator written in JavaScript that works in the browser.

**Architecture:**
\`\`\`

   xterm.js (UI)      Handles display, colors, cursor

   PTY Process        Manages shell process
  
   Shell (zsh/bash)   Actual command execution

\`\`\`

**LocalBrain terminal setup:**
\`\`\`typescript
import { Terminal } from 'xterm';
import { FitAddon } from 'xterm-addon-fit';

const term = new Terminal({
  theme: {
    background: '#0a0a0f',
    foreground: '#f0f0f0',
    cursor: '#3b82f6'
  },
  fontFamily: 'JetBrains Mono',
  fontSize: 14
});

term.open(document.getElementById('terminal'));
\`\`\`

### PTY Wrappers

**What is PTY?**
Pseudo Terminal - creates a virtual terminal that programs think is real.

**Why LocalBrain avoids node-pty:**
\`\`\`javascript
// node-pty (requires compilation)
import { spawn } from 'node-pty';
const pty = spawn('bash', [], { 
  cols: 80, 
  rows: 30 
});

// LocalBrain's approach (no compilation)
import { spawn } from 'child_process';
const proc = spawn('bash', [], {
  env: process.env,
  stdio: ['pipe', 'pipe', 'pipe']
});
\`\`\`

**Trade-offs:**
-  No native compilation needed
-  Works immediately after npm install
-  No terminal resize support
-  Some programs may not work correctly

### Node fs

**File system operations in LocalBrain:**
\`\`\`typescript
import { promises as fs } from 'fs';
import path from 'path';

// Secure file access
class SecureFileSystem {
  constructor(private allowedRoots: string[]) {}
  
  async readFile(filePath: string): Promise<string> {
    const resolved = path.resolve(filePath);
    
    // Security check
    if (!this.isInAllowedRoot(resolved)) {
      throw new Error('Access denied: Outside allowed directories');
    }
    
    return fs.readFile(resolved, 'utf-8');
  }
  
  private isInAllowedRoot(filePath: string): boolean {
    return this.allowedRoots.some(root => 
      filePath.startsWith(path.resolve(root))
    );
  }
}
\`\`\`

### electron-store

**What is electron-store?**
Simple data persistence for Electron apps - like localStorage but for Node.js.

**Where data is stored:**
\`\`\`
macOS: ~/Library/Application Support/LocalBrain/config.json
Windows: %APPDATA%/LocalBrain/config.json
Linux: ~/.config/LocalBrain/config.json
\`\`\`

**Usage example:**
\`\`\`typescript
import Store from 'electron-store';

const store = new Store({
  schema: {
    apiKey: { type: 'string' },
    theme: { type: 'string', default: 'dark' }
  }
});

// Save
store.set('apiKey', 'sk-...');

// Load
const key = store.get('apiKey');
\`\`\`

### Monaco Editor

**What is Monaco?**
The code editor that powers VS Code, available as a standalone component.

**Read-only by default - why?**
- **Safety**: Prevents accidental edits during viewing
- **Clarity**: Users explicitly choose when to edit
- **LLM-friendly**: AI can read without modifying

**Monaco in LocalBrain:**
\`\`\`typescript
import * as monaco from 'monaco-editor';

const editor = monaco.editor.create(container, {
  value: fileContent,
  language: 'typescript',
  theme: 'vs-dark',
  readOnly: true, // Default read-only
  minimap: { enabled: false },
  scrollBeyondLastLine: false
});

// Enable editing when user clicks "Edit"
function enableEditing() {
  editor.updateOptions({ readOnly: false });
}
\`\`\`

### electron-builder

**What does it do?**
Packages your Electron app into distributables (DMG, EXE, AppImage).

**Build configuration:**
\`\`\`yaml
# electron-builder.yml
appId: com.localbrain.app
productName: LocalBrain
directories:
  output: dist
mac:
  category: public.app-category.developer-tools
  icon: build/icon.icns
  hardenedRuntime: true
  gatekeeperAssess: false
dmg:
  contents:
    - x: 130
      y: 220
    - x: 410
      y: 220
      type: link
      path: /Applications
\`\`\`

##  Your Questions Answered

### 1. What are package.json files for?

**package.json** is the heart of any Node.js project. It defines:
- **Dependencies**: What libraries your project needs
- **Scripts**: Commands to run your project
- **Metadata**: Name, version, author, license

**LocalBrain has multiple package.json files:**
\`\`\`
Root package.json  Workspace configuration
 apps/desktop/package.json  Electron app specifics
 packages/core/package.json  Core logic package
 packages/ui/package.json  Shared UI components
 packages/types/package.json  Shared TypeScript types
\`\`\`

### 2. Why .env.example rather than .env?

**Security & Collaboration:**
\`\`\`bash
# .env (NEVER commit this!)
OPENAI_API_KEY=sk-real-secret-key-here
DATABASE_PASSWORD=actual-password

# .env.example (Safe to commit)
OPENAI_API_KEY=sk-your-api-key-here
DATABASE_PASSWORD=your-password-here
\`\`\`

**.gitignore always includes:**
\`\`\`
.env
.env.local
.env.*.local
\`\`\`

### 3. Why do we have to generate icons?

**Platform requirements:**
- macOS needs: 16x16, 32x32, 64x64, 128x128, 256x256, 512x512, 1024x1024
- Windows needs: ICO format with multiple sizes
- Linux needs: PNG in various sizes

**Icon generation script:**
\`\`\`javascript
// scripts/make-icons.js
const sharp = require('sharp');
const sizes = [16, 32, 64, 128, 256, 512, 1024];

sizes.forEach(size => {
  sharp('icon-source.png')
    .resize(size, size)
    .toFile(\`icons/icon-\${size}.png\`);
});
\`\`\`

### 4. If we had a mobile version, would it have apps/mobile/??

**Yes! The monorepo structure scales:**
\`\`\`
localbrain/
 apps/
    desktop/     # Electron app
    mobile/      # React Native app
    web/         # Next.js web app
 packages/
    core/        # Shared business logic
    ui-desktop/  # Desktop-specific UI
    ui-mobile/   # Mobile-specific UI
    ui-shared/   # Shared components
\`\`\`

### 5. What happens in main/?

**Main process responsibilities:**
\`\`\`typescript
// main/index.ts

// 1. App lifecycle
app.on('ready', createWindow);
app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') app.quit();
});

// 2. Native APIs
ipcMain.handle('read-file', async (event, path) => {
  return fs.readFile(path, 'utf-8');
});

// 3. Window management
function createWindow() {
  mainWindow = new BrowserWindow({...});
}

// 4. Security
app.on('web-contents-created', (event, contents) => {
  contents.on('new-window', (event) => {
    event.preventDefault(); // Prevent popup windows
  });
});
\`\`\`

### 6. What are the App.tsx functions?

**App.tsx is the root React component:**
\`\`\`tsx
// App.tsx structure
function App() {
  // 1. Global state management
  const [user, setUser] = useState(null);
  const [theme, setTheme] = useState('dark');
  
  // 2. IPC communication setup
  useEffect(() => {
    window.electron.onThemeChange(setTheme);
  }, []);
  
  // 3. Route/layout management
  return (
    <ThemeProvider theme={theme}>
      <Layout>
        <ChatPane />
        <TerminalPane />
        <PreviewPane />
        <FileExplorer />
      </Layout>
    </ThemeProvider>
  );
}
\`\`\`

### 7. What are packages/*/src? Why .ts vs .tsx?

**File extensions tell TypeScript how to parse:**
- **.ts**: Pure TypeScript (no JSX)
- **.tsx**: TypeScript with JSX (React components)

**Examples:**
\`\`\`typescript
// packages/core/src/agent.ts (No UI, pure logic)
export class AIAgent {
  async processCommand(text: string): Promise<Command> {
    // Pure TypeScript logic
  }
}

// packages/ui/src/Button.tsx (React component)
export function Button({ onClick, children }: Props) {
  return ( //  JSX requires .tsx
    <button onClick={onClick}>{children}</button>
  );
}
\`\`\`

### 8. What is the RMS threshold?

**RMS (Root Mean Square) for voice detection:**
\`\`\`typescript
// Simple voice activity detection
function calculateRMS(audioData: Float32Array): number {
  let sum = 0;
  for (let i = 0; i < audioData.length; i++) {
    sum += audioData[i] * audioData[i];
  }
  return Math.sqrt(sum / audioData.length);
}

// Usage
const RMS_THRESHOLD = 0.01; // Adjust based on mic sensitivity
if (calculateRMS(audioBuffer) > RMS_THRESHOLD) {
  console.log("Voice detected!");
}
\`\`\`

**Visual representation:**
\`\`\`
Silence: ----__--__----__-- (RMS  0.001)
Speech:  ==== (RMS  0.05)
          Threshold = 0.01
\`\`\`

### 9. What is a Node.js child process?

**Child processes let Node.js run other programs:**
\`\`\`typescript
import { spawn, exec, fork } from 'child_process';

// spawn - Streaming interface
const ls = spawn('ls', ['-la']);
ls.stdout.on('data', (data) => {
  console.log(\`Output: \${data}\`);
});

// exec - Buffer output
exec('git status', (error, stdout, stderr) => {
  console.log(stdout);
});

// fork - Run another Node.js script
const worker = fork('worker.js');
worker.send({ cmd: 'START' });
\`\`\`

**LocalBrain uses this for terminals:**
\`\`\`typescript
const shell = spawn(process.env.SHELL || '/bin/zsh');
shell.stdout.pipe(terminalOutput);
userInput.pipe(shell.stdin);
\`\`\`

### 10. What does "string" mean in No. 5 LLM integration?

**It's a TypeScript type annotation:**
\`\`\`typescript
interface AgentCapabilities {
  runCommand(cmd: string, cwd?: string): Promise<string>;
  //              ^^^^^^       ^^^^^^               ^^^^^^
  //              Type of cmd  Optional param      Return type
}

// Usage:
agent.runCommand("ls -la", "/home/user"); //  Valid
agent.runCommand(123, "/home"); //  Type error! 123 is not string
\`\`\`

### 11. Can we say a plugin is an app by itself?

**Yes and no:**

**Plugin characteristics:**
-  Has its own package.json
-  Contains independent logic
-  Can have UI components
-  Cannot run standalone
-  Depends on host app APIs

**Plugin structure:**
\`\`\`javascript
// plugins/translator/index.js
module.exports = {
  activate(context) {
    // Plugin is like a mini-app that runs inside LocalBrain
    context.registerCommand('translate', async (text, targetLang) => {
      const result = await translateAPI(text, targetLang);
      context.showResult(result);
    });
  }
};
\`\`\`

### 12. Relationship between TailwindCSS, React, Vite, and TypeScript?

**They each handle different layers:**
\`\`\`

      TypeScript (.tsx)            Type safety

      React Components             UI logic

      TailwindCSS Classes          Styling

      Vite Dev Server              Build/serve

\`\`\`

**Example component using all four:**
\`\`\`tsx
// ChatMessage.tsx
interface Props {
  message: string;
  timestamp: Date;
  isUser: boolean;
}

export function ChatMessage({ message, timestamp, isUser }: Props) {
  return (
    <div className={\`
      p-4 mb-2 rounded-lg transition-all
      \${isUser 
        ? 'bg-blue-500/20 ml-auto max-w-[80%]' 
        : 'bg-gray-500/20 mr-auto max-w-[80%]'
      }
    \`}>
      <p className="text-white">{message}</p>
      <time className="text-xs text-gray-400">
        {timestamp.toLocaleTimeString()}
      </time>
    </div>
  );
}
\`\`\`

**The flow:**
1. **TypeScript** checks types at compile time
2. **React** handles component logic and state
3. **Tailwind** provides utility classes for styling
4. **Vite** bundles everything and serves it fast

### 13. What is node-pty?

**node-pty** creates pseudo terminals (PTY) for full terminal emulation:

**Without PTY (basic):**
\`\`\`typescript
// Can't handle: vim, htop, colored output
const proc = spawn('bash');
proc.stdout.on('data', console.log);
\`\`\`

**With PTY (full terminal):**
\`\`\`typescript
import * as pty from 'node-pty';

// Handles EVERYTHING a real terminal can
const ptyProcess = pty.spawn('bash', [], {
  cols: 80,
  rows: 30,
  cwd: process.env.HOME
});

// Programs think they're in a real terminal
ptyProcess.write('vim\r'); // Works perfectly!
\`\`\`

**Why LocalBrain avoids it:**
- Requires C++ compilation
- Platform-specific builds
- Installation can fail
- Adds complexity for basic needs

### 14. Can I call the first interaction on an LLM chat session a bootstrap?

**Yes! "Bootstrap" is a perfect term:**

**Bootstrap in LocalBrain context:**
\`\`\`typescript
class AIAgent {
  async bootstrap() {
    // Initialize the conversation context
    const systemPrompt = \`
      You are LocalBrain, an AI assistant with access to:
      - File system (allowed directories only)
      - Terminal execution
      - Voice synthesis
      
      Current directory: \${process.cwd()}
      Platform: \${process.platform}
    \`;
    
    // First message establishes context
    this.conversation = [{
      role: 'system',
      content: systemPrompt
    }];
  }
}
\`\`\`

**Other valid terms:**
- **Initialization**: Setting up the session
- **Priming**: Preparing the model
- **Context injection**: Adding system knowledge
- **Seeding**: Planting initial information

##  Summary

LocalBrain combines these technologies to create a powerful, privacy-first AI command center:

1. **Electron** provides the desktop app framework
2. **React + TypeScript** create a type-safe, modern UI
3. **Vite** ensures lightning-fast development
4. **TailwindCSS** enables rapid, consistent styling
5. **pnpm workspaces** organize the modular architecture
6. **xterm.js** provides terminal emulation
7. **Monaco Editor** offers VS Code-like editing
8. **electron-store** persists user settings
9. **electron-builder** packages everything for distribution

Each technology was chosen for specific reasons, creating a cohesive system that's both powerful for users and maintainable for developers.`;
        
        
        // Apply syntax highlighting to code blocks
        function applySyntaxHighlighting() {
            const codeBlocks = document.querySelectorAll('pre code');
            
            codeBlocks.forEach(block => {
                const code = block.textContent;
                const highlightedCode = highlightCode(code);
                block.innerHTML = highlightedCode;
                
            });
        }
        
        // Get tooltip text for code elements
        function getTooltipForCode(type, text) {
            const tooltips = {
                keyword: {
                    'const': `<b>const</b> - Constant Declaration Keyword<br><br>
                        <b>Purpose:</b> Creates an immutable binding to a value<br>
                        <b>Scope:</b> Block-scoped (within { } brackets)<br>
                        <b>Reassignment:</b> Cannot be reassigned after initialization<br>
                        <b>Hoisting:</b> Hoisted but in Temporal Dead Zone until declared<br>
                        <b>Best Practice:</b> Use by default for all variables<br>
                        <b>Example:</b> const PI = 3.14159;<br>
                        <b>Common Error:</b> "Assignment to constant variable" when trying to reassign`,
                    
                    'let': `<b>let</b> - Block-Scoped Variable Declaration<br><br>
                        <b>Purpose:</b> Declares a reassignable, block-scoped variable<br>
                        <b>Scope:</b> Limited to enclosing block { }<br>
                        <b>Reassignment:</b> Can be changed after declaration<br>
                        <b>Hoisting:</b> Hoisted but not accessible before declaration<br>
                        <b>Use Case:</b> Loop counters, values that change<br>
                        <b>Example:</b> let count = 0; count++;<br>
                        <b>Replaces:</b> var in modern JavaScript`,
                    
                    'var': `<b>var</b> - Function-Scoped Variable (Legacy)<br><br>
                        <b> Status:</b> Deprecated - avoid in modern code<br>
                        <b>Scope:</b> Function-scoped or globally-scoped<br>
                        <b>Hoisting:</b> Hoisted and initialized as undefined<br>
                        <b>Problems:</b> Scope leaking, redeclaration allowed<br>
                        <b>Example:</b> var x = 1; // Don't use this<br>
                        <b>Replace With:</b> const or let<br>
                        <b>Why Avoid:</b> Causes bugs due to unexpected scoping`,
                    
                    'function': `<b>function</b> - Function Declaration Keyword<br><br>
                        <b>Purpose:</b> Declares a named, reusable block of code<br>
                        <b>Syntax:</b> function name(parameters) { body }<br>
                        <b>Hoisting:</b> Fully hoisted - can call before declaration<br>
                        <b>Returns:</b> undefined by default, or specified value<br>
                        <b>Creates:</b> New execution context and scope<br>
                        <b>Example:</b> function add(a, b) { return a + b; }<br>
                        <b>Alternative:</b> Arrow functions () => {}`,
                    
                    'async': `<b>async</b> - Asynchronous Function Modifier<br><br>
                        <b>Purpose:</b> Declares function that returns a Promise<br>
                        <b>Enables:</b> Use of await keyword inside function<br>
                        <b>Returns:</b> Always returns a Promise<br>
                        <b>Syntax:</b> async function fetchData() { ... }<br>
                        <b>Error Handling:</b> Use try/catch for errors<br>
                        <b>Example:</b> async () => await fetch('/api/data')<br>
                        <b>Benefit:</b> Makes async code look synchronous`,
                    
                    'await': `<b>await</b> - Promise Resolution Operator<br><br>
                        <b>Purpose:</b> Pauses async function until Promise resolves<br>
                        <b>Context:</b> Only works inside async functions<br>
                        <b>Returns:</b> Resolved value or throws rejection<br>
                        <b>Syntax:</b> const result = await promise;<br>
                        <b>Blocks:</b> Execution continues after resolution<br>
                        <b>Example:</b> const data = await fetch(url);<br>
                        <b>Error:</b> "await is only valid in async function"`,
                    
                    'class': `<b>class</b> - Class Declaration (ES6+)<br><br>
                        <b>Purpose:</b> Template for creating objects (OOP)<br>
                        <b>Contains:</b> Constructor, methods, properties<br>
                        <b>Syntax:</b> class Name { constructor() {} }<br>
                        <b>Instantiation:</b> Use 'new' keyword<br>
                        <b>Inheritance:</b> Use 'extends' for subclasses<br>
                        <b>Example:</b> class User { constructor(name) {} }<br>
                        <b>Under Hood:</b> Syntactic sugar over prototypes`,
                    
                    'interface': `<b>interface</b> - TypeScript Type Contract<br><br>
                        <b>Purpose:</b> Defines shape of objects/classes<br>
                        <b>Language:</b> TypeScript only (not JavaScript)<br>
                        <b>Runtime:</b> Removed during compilation<br>
                        <b>Syntax:</b> interface Name { prop: type; }<br>
                        <b>Implements:</b> Classes can implement interfaces<br>
                        <b>Example:</b> interface User { name: string; }<br>
                        <b>vs Type:</b> Interfaces can be extended/merged`,
                    
                    'import': `<b>import</b> - ES6 Module Import Statement<br><br>
                        <b>Purpose:</b> Loads exported values from modules<br>
                        <b>Types:</b> Named, default, namespace, side-effect<br>
                        <b>Named:</b> import { func } from './module';<br>
                        <b>Default:</b> import MyClass from './module';<br>
                        <b>All:</b> import * as Utils from './utils';<br>
                        <b>Dynamic:</b> import('./module').then(...)<br>
                        <b>Must Be:</b> At top of file (except dynamic)`,
                    
                    'export': `<b>export</b> - ES6 Module Export Statement<br><br>
                        <b>Purpose:</b> Makes values available to other modules<br>
                        <b>Types:</b> Named exports, default export<br>
                        <b>Named:</b> export const myFunc = () => {};<br>
                        <b>Default:</b> export default class MyClass {}<br>
                        <b>Re-export:</b> export { x } from './other';<br>
                        <b>Limit:</b> One default export per module<br>
                        <b>Access:</b> Via import in other files`,
                    
                    'return': `<b>return</b> - Function Exit & Value Statement<br><br>
                        <b>Purpose:</b> Exits function and optionally returns value<br>
                        <b>Behavior:</b> Immediately stops function execution<br>
                        <b>Default:</b> Functions return undefined if no return<br>
                        <b>Multiple:</b> Only first return executes<br>
                        <b>Example:</b> return x * 2;<br>
                        <b>In Async:</b> Wrapped in Promise automatically<br>
                        <b>Void:</b> Use return; to exit without value`,
                    
                    'if': `<b>if</b> - Conditional Execution Statement<br><br>
                        <b>Purpose:</b> Executes code block if condition is truthy<br>
                        <b>Syntax:</b> if (condition) { code }<br>
                        <b>Truthy:</b> true, 1, "text", [], {}, etc.<br>
                        <b>Falsy:</b> false, 0, "", null, undefined, NaN<br>
                        <b>Chain:</b> else if for multiple conditions<br>
                        <b>Example:</b> if (x > 0) { positive(); }<br>
                        <b>Ternary:</b> condition ? true : false`,
                    
                    'else': `<b>else</b> - Alternative Conditional Branch<br><br>
                        <b>Purpose:</b> Executes when if condition is falsy<br>
                        <b>Syntax:</b> if (cond) {} else { alternate }<br>
                        <b>Chain:</b> else if (cond2) for multiple paths<br>
                        <b>Must Follow:</b> Immediately after if block<br>
                        <b>Example:</b> if (age >= 18) {} else { minor() }<br>
                        <b>Optional:</b> Not required after if<br>
                        <b>Scope:</b> Creates new block scope`,
                    
                    'for': `<b>for</b> - Iteration Loop Statement<br><br>
                        <b>Purpose:</b> Repeats code block specific times<br>
                        <b>Classic:</b> for (let i=0; i<10; i++) {}<br>
                        <b>For...in:</b> Iterates object keys<br>
                        <b>For...of:</b> Iterates iterable values<br>
                        <b>Parts:</b> (initialization; condition; update)<br>
                        <b>Break:</b> Exit loop early<br>
                        <b>Continue:</b> Skip to next iteration`,
                    
                    'while': `<b>while</b> - Conditional Loop Statement<br><br>
                        <b>Purpose:</b> Repeats while condition is truthy<br>
                        <b>Syntax:</b> while (condition) { code }<br>
                        <b>Check:</b> Condition tested before each iteration<br>
                        <b>Infinite:</b> while(true) needs break to exit<br>
                        <b>Example:</b> while (i < array.length) { i++ }<br>
                        <b>vs Do-While:</b> May never execute if false<br>
                        <b>Use Case:</b> Unknown iteration count`,
                    
                    'try': `<b>try</b> - Error Handling Block Start<br><br>
                        <b>Purpose:</b> Wraps code that might throw errors<br>
                        <b>Syntax:</b> try { riskyCode() } catch(e) {}<br>
                        <b>Continues:</b> Execution continues after catch<br>
                        <b>Scope:</b> Creates new block scope<br>
                        <b>Must Have:</b> catch or finally block<br>
                        <b>Example:</b> try { JSON.parse(data) }<br>
                        <b>Best Practice:</b> Keep try blocks small`,
                    
                    'catch': `<b>catch</b> - Error Handling Block<br><br>
                        <b>Purpose:</b> Handles errors thrown in try block<br>
                        <b>Syntax:</b> catch (error) { handleError() }<br>
                        <b>Parameter:</b> Receives thrown error object<br>
                        <b>Executes:</b> Only if try block throws<br>
                        <b>Can:</b> Re-throw errors with throw<br>
                        <b>Example:</b> catch (e) { console.error(e) }<br>
                        <b>Optional:</b> Parameter can be omitted`,
                    
                    'throw': `<b>throw</b> - Error Throwing Statement<br><br>
                        <b>Purpose:</b> Manually triggers an exception<br>
                        <b>Syntax:</b> throw new Error('message');<br>
                        <b>Can Throw:</b> Any value, not just Error<br>
                        <b>Stops:</b> Execution immediately<br>
                        <b>Bubbles:</b> Up to nearest catch block<br>
                        <b>Example:</b> throw new TypeError('Invalid');<br>
                        <b>Custom:</b> Can throw custom error classes`,
                    
                    'new': `<b>new</b> - Instance Creation Operator<br><br>
                        <b>Purpose:</b> Creates instance of class/constructor<br>
                        <b>Process:</b> 1) Create object 2) Set prototype 3) Call constructor 4) Return object<br>
                        <b>Syntax:</b> new ClassName(arguments)<br>
                        <b>Example:</b> new Date(), new Array(5)<br>
                        <b>Required For:</b> Classes, constructors<br>
                        <b>Returns:</b> New object instance<br>
                        <b>Without new:</b> May cause errors or unexpected behavior`,
                    
                    'this': `<b>this</b> - Context Reference Keyword<br><br>
                        <b>Purpose:</b> References current execution context<br>
                        <b>In Object:</b> The object itself<br>
                        <b>In Class:</b> The instance<br>
                        <b>In Function:</b> Depends on how called<br>
                        <b>Arrow =>:</b> Inherits from enclosing scope<br>
                        <b>Bind:</b> Can be explicitly set with .bind()<br>
                        <b>Gotcha:</b> Changes based on invocation`,
                    
                    'super': `<b>super</b> - Parent Class Reference<br><br>
                        <b>Purpose:</b> Access parent class methods/constructor<br>
                        <b>In Constructor:</b> super() calls parent constructor<br>
                        <b>Must:</b> Call super() before using 'this'<br>
                        <b>Methods:</b> super.methodName() calls parent<br>
                        <b>Example:</b> class Dog extends Animal { super() }<br>
                        <b>Only In:</b> Classes that extend another<br>
                        <b>Static:</b> Works in static methods too`,
                    
                    'extends': `<b>extends</b> - Class Inheritance Keyword<br><br>
                        <b>Purpose:</b> Creates class based on another class<br>
                        <b>Syntax:</b> class Child extends Parent {}<br>
                        <b>Inherits:</b> All methods and properties<br>
                        <b>Override:</b> Can redefine parent methods<br>
                        <b>Super:</b> Access parent with super keyword<br>
                        <b>Example:</b> class Dog extends Animal {}<br>
                        <b>Prototype:</b> Sets up prototype chain`,
                    
                    'implements': `<b>implements</b> - TypeScript Interface Contract<br><br>
                        <b>Purpose:</b> Class must satisfy interface shape<br>
                        <b>Language:</b> TypeScript only<br>
                        <b>Syntax:</b> class X implements Interface {}<br>
                        <b>Multiple:</b> Can implement many interfaces<br>
                        <b>Must:</b> Include all interface properties<br>
                        <b>Example:</b> class User implements IUser {}<br>
                        <b>Compile:</b> Checked at compile time only`,
                    
                    'typeof': `<b>typeof</b> - Type Checking Operator<br><br>
                        <b>Purpose:</b> Returns string of operand's type<br>
                        <b>Returns:</b> "string", "number", "boolean", "object", "function", "undefined", "symbol", "bigint"<br>
                        <b>Gotcha:</b> typeof null === "object" (bug)<br>
                        <b>Arrays:</b> Returns "object" for arrays<br>
                        <b>Example:</b> typeof 42 === "number"<br>
                        <b>Use:</b> Type checking before operations<br>
                        <b>Note:</b> Different from TypeScript's typeof`,
                    
                    'instanceof': `<b>instanceof</b> - Instance Checking Operator<br><br>
                        <b>Purpose:</b> Tests if object is instance of class<br>
                        <b>Syntax:</b> object instanceof Constructor<br>
                        <b>Returns:</b> true or false<br>
                        <b>Checks:</b> Entire prototype chain<br>
                        <b>Example:</b> [] instanceof Array // true<br>
                        <b>Works With:</b> Classes and constructors<br>
                        <b>Not For:</b> Primitives (use typeof)`,
                    
                    'true': `<b>true</b> - Boolean Literal True<br><br>
                        <b>Type:</b> Primitive boolean value<br>
                        <b>Truthy:</b> Always evaluates as truthy<br>
                        <b>Number:</b> Converts to 1<br>
                        <b>String:</b> Converts to "true"<br>
                        <b>Logic:</b> true && x returns x<br>
                        <b>Opposite:</b> !true === false<br>
                        <b>Case:</b> Lowercase only (True is variable)`,
                    
                    'false': `<b>false</b> - Boolean Literal False<br><br>
                        <b>Type:</b> Primitive boolean value<br>
                        <b>Falsy:</b> One of 6 falsy values in JS<br>
                        <b>Number:</b> Converts to 0<br>
                        <b>String:</b> Converts to "false"<br>
                        <b>Logic:</b> false && x returns false<br>
                        <b>Opposite:</b> !false === true<br>
                        <b>Others:</b> 0, "", null, undefined, NaN`,
                    
                    'null': `<b>null</b> - Intentional Absence Value<br><br>
                        <b>Purpose:</b> Represents intentional emptiness<br>
                        <b>Type:</b> typeof null === "object" (bug)<br>
                        <b>vs undefined:</b> Explicitly set vs not set<br>
                        <b>Falsy:</b> Evaluates to false in conditions<br>
                        <b>Check:</b> value === null (strict equality)<br>
                        <b>JSON:</b> Valid in JSON (undefined isn't)<br>
                        <b>Use:</b> Reset variables, missing objects`,
                    
                    'undefined': `<b>undefined</b> - Uninitialized Value<br><br>
                        <b>Purpose:</b> Variable declared but not assigned<br>
                        <b>Type:</b> typeof undefined === "undefined"<br>
                        <b>Default:</b> Function params, missing returns<br>
                        <b>Falsy:</b> Evaluates to false<br>
                        <b>Check:</b> typeof x === "undefined"<br>
                        <b>void:</b> void 0 always returns undefined<br>
                        <b>Avoid:</b> Don't assign undefined explicitly`,
                    
                    'void': `<b>void</b> - TypeScript No Return Type<br><br>
                        <b>Purpose:</b> Function returns nothing (TS)<br>
                        <b>JavaScript:</b> void expr returns undefined<br>
                        <b>TypeScript:</b> function fn(): void {}<br>
                        <b>Different:</b> From undefined return type<br>
                        <b>Example:</b> onClick: () => void<br>
                        <b>IIFE:</b> void function() {}() executes<br>
                        <b>Use:</b> Side effects without return value`
                },
                operator: {
                    '=>': `<b>=></b> - Arrow Function Operator<br><br>
                        <b>Purpose:</b> Concise function syntax (ES6+)<br>
                        <b>Syntax:</b> (params) => expression or => { block }<br>
                        <b>This Binding:</b> Inherits 'this' from parent scope<br>
                        <b>No Arguments:</b> No arguments object<br>
                        <b>Implicit Return:</b> Without { } returns expression<br>
                        <b>Example:</b> const double = x => x * 2;<br>
                        <b>Best For:</b> Callbacks, array methods, short functions`,
                    
                    '===': `<b>===</b> - Strict Equality Operator<br><br>
                        <b>Purpose:</b> Compares value AND type<br>
                        <b>No Coercion:</b> No type conversion performed<br>
                        <b>Examples:</b> 5 === 5 (true), 5 === "5" (false)<br>
                        <b>NaN:</b> NaN === NaN is false (use Number.isNaN)<br>
                        <b>Objects:</b> Compares references, not contents<br>
                        <b>Best Practice:</b> Always use over ==<br>
                        <b>Performance:</b> Faster than == (no conversion)`,
                    
                    '!==': `<b>!==</b> - Strict Inequality Operator<br><br>
                        <b>Purpose:</b> Opposite of === (not equal in type OR value)<br>
                        <b>No Coercion:</b> No type conversion<br>
                        <b>Examples:</b> 5 !== "5" (true), 5 !== 5 (false)<br>
                        <b>Preferred:</b> Over != for predictability<br>
                        <b>Objects:</b> Different references are not equal<br>
                        <b>Null Check:</b> value !== null && value !== undefined<br>
                        <b>Logic:</b> !(a === b) equivalent`,
                    
                    '==': `<b>==</b> - Loose Equality (Type Coercion) <br><br>
                        <b>Warning:</b> Performs type conversion - avoid!<br>
                        <b>Coercion:</b> Converts types before comparing<br>
                        <b>Weird:</b> 0 == false (true), "" == false (true)<br>
                        <b>null/undefined:</b> null == undefined (true)<br>
                        <b>Arrays:</b> [] == false (true) - confusing!<br>
                        <b>Replace:</b> Use === for predictable code<br>
                        <b>ESLint:</b> eqeqeq rule disallows this`,
                    
                    '!=': `<b>!=</b> - Loose Inequality (Type Coercion) <br><br>
                        <b>Warning:</b> Performs type conversion - avoid!<br>
                        <b>Opposite:</b> Of == with same coercion rules<br>
                        <b>Confusing:</b> 5 != "5" (false) due to coercion<br>
                        <b>Replace:</b> Always use !== instead<br>
                        <b>Example:</b> 0 != false (false) - unexpected!<br>
                        <b>Logic:</b> !(a == b) equivalent<br>
                        <b>Linting:</b> Most style guides forbid this`,
                    
                    '&&': `<b>&&</b> - Logical AND Operator<br><br>
                        <b>Purpose:</b> Returns first falsy or last truthy value<br>
                        <b>Short Circuit:</b> Stops at first falsy value<br>
                        <b>Returns:</b> Not always boolean!<br>
                        <b>Guard:</b> obj && obj.property (null safety)<br>
                        <b>Conditional:</b> isReady && doAction()<br>
                        <b>Falsy:</b> false, 0, "", null, undefined, NaN<br>
                        <b>Example:</b> name && "Hello " + name`,
                    
                    '||': `<b>||</b> - Logical OR Operator<br><br>
                        <b>Purpose:</b> Returns first truthy or last falsy value<br>
                        <b>Short Circuit:</b> Stops at first truthy value<br>
                        <b>Default Values:</b> name || "Anonymous"<br>
                        <b>Fallback:</b> Common pattern before ??<br>
                        <b>Problem:</b> 0 || 10 returns 10 (0 is falsy)<br>
                        <b>Chain:</b> a || b || c || defaultValue<br>
                        <b>Not Always Boolean:</b> Returns actual value`,
                    
                    '!': `<b>!</b> - Logical NOT Operator<br><br>
                        <b>Purpose:</b> Inverts truthiness of value<br>
                        <b>Returns:</b> Always boolean (true/false)<br>
                        <b>Double:</b> !! converts to boolean<br>
                        <b>Examples:</b> !true = false, !"" = true<br>
                        <b>Precedence:</b> Higher than &&, ||<br>
                        <b>Common:</b> if (!isValid) { ... }<br>
                        <b>Boolean Cast:</b> !!value same as Boolean(value)`,
                    
                    '++': `<b>++</b> - Increment Operator<br><br>
                        <b>Purpose:</b> Adds 1 to numeric value<br>
                        <b>Prefix:</b> ++x increments then returns new value<br>
                        <b>Postfix:</b> x++ returns then increments<br>
                        <b>Example:</b> let i=0; console.log(i++) // 0<br>
                        <b>Example:</b> let i=0; console.log(++i) // 1<br>
                        <b>Mutates:</b> Changes original variable<br>
                        <b>Common:</b> for loops, counters`,
                    
                    '--': `<b>--</b> - Decrement Operator<br><br>
                        <b>Purpose:</b> Subtracts 1 from numeric value<br>
                        <b>Prefix:</b> --x decrements then returns new value<br>
                        <b>Postfix:</b> x-- returns then decrements<br>
                        <b>Example:</b> let i=5; console.log(i--) // 5<br>
                        <b>Example:</b> let i=5; console.log(--i) // 4<br>
                        <b>Mutates:</b> Changes original variable<br>
                        <b>Use:</b> Countdown loops, array traversal`,
                    
                    '...': `<b>...</b> - Spread/Rest Operator (ES6)<br><br>
                        <b>Spread:</b> Expands iterables into elements<br>
                        <b>Arrays:</b> [...arr1, ...arr2] concatenates<br>
                        <b>Objects:</b> {...obj1, ...obj2} merges<br>
                        <b>Rest:</b> Collects remaining arguments<br>
                        <b>Function:</b> (...args) => all parameters<br>
                        <b>Clone:</b> [...array] or {...object}<br>
                        <b>Max:</b> Math.max(...numbers)`,
                    
                    '?.': `<b>?.</b> - Optional Chaining (ES2020)<br><br>
                        <b>Purpose:</b> Safe property access on null/undefined<br>
                        <b>Returns:</b> undefined if chain breaks<br>
                        <b>Property:</b> obj?.prop<br>
                        <b>Method:</b> obj?.method?.(args)<br>
                        <b>Array:</b> arr?.[index]<br>
                        <b>Replaces:</b> obj && obj.prop && obj.prop.sub<br>
                        <b>Example:</b> user?.address?.street`,
                    
                    '??': `<b>??</b> - Nullish Coalescing (ES2020)<br><br>
                        <b>Purpose:</b> Default for null/undefined only<br>
                        <b>vs ||:</b> Doesn't treat 0, "", false as nullish<br>
                        <b>Use:</b> count ?? 0 (keeps 0 if present)<br>
                        <b>Only Nullish:</b> null and undefined<br>
                        <b>Example:</b> name ?? "Anonymous"<br>
                        <b>Chain:</b> a ?? b ?? c ?? default<br>
                        <b>With ?.</b> obj?.prop ?? defaultValue`
                },
                function: {
                    'console': `<b>console</b> - Debug Output Object<br><br>
                        <b>Purpose:</b> Debugging and logging interface<br>
                        <b>Methods:</b> log, error, warn, info, debug, table, time<br>
                        <b>Environments:</b> Browser DevTools, Node.js terminal<br>
                        <b>Not For:</b> Production user messages<br>
                        <b>Styling:</b> %c for CSS in browser<br>
                        <b>Objects:</b> Shows expandable tree view<br>
                        <b>Example:</b> console.log('%cStyled', 'color: red')`,
                    
                    'log': `<b>log()</b> - Console Output Method<br><br>
                        <b>Purpose:</b> Prints values to console<br>
                        <b>Syntax:</b> console.log(value1, value2, ...)<br>
                        <b>Multiple:</b> Comma-separated values<br>
                        <b>Templates:</b> console.log(\`Value: \${x}\`)<br>
                        <b>Objects:</b> Shows properties expandable<br>
                        <b>Returns:</b> undefined<br>
                        <b>Production:</b> Remove or use proper logging`,
                    
                    'error': `<b>error()</b> - Console Error Method<br><br>
                        <b>Purpose:</b> Logs errors with stack trace<br>
                        <b>Visual:</b> Red text/icon in console<br>
                        <b>Stack:</b> Shows call stack in browsers<br>
                        <b>Syntax:</b> console.error('Failed:', error)<br>
                        <b>vs log:</b> Semantic difference, filtering<br>
                        <b>Node:</b> Writes to stderr stream<br>
                        <b>Use:</b> Catch blocks, error handling`,
                    
                    'spawn': `<b>spawn()</b> - Child Process Creator<br><br>
                        <b>Module:</b> child_process (Node.js)<br>
                        <b>Purpose:</b> Launches new process with streaming<br>
                        <b>Syntax:</b> spawn(command, [args], options)<br>
                        <b>Streams:</b> stdin, stdout, stderr pipes<br>
                        <b>Events:</b> data, error, close, exit<br>
                        <b>Example:</b> spawn('ls', ['-la', '/tmp'])<br>
                        <b>vs exec:</b> Better for large outputs, real-time`,
                    
                    'exec': `<b>exec()</b> - Shell Command Executor<br><br>
                        <b>Module:</b> child_process (Node.js)<br>
                        <b>Purpose:</b> Runs shell command, buffers output<br>
                        <b>Syntax:</b> exec(command, callback)<br>
                        <b>Shell:</b> Uses system shell (bash/cmd)<br>
                        <b>Buffer:</b> Collects all output in memory<br>
                        <b>Callback:</b> (error, stdout, stderr) => {}<br>
                        <b>Limit:</b> Default 1MB buffer (configurable)`,
                    
                    'require': `<b>require()</b> - CommonJS Import<br><br>
                        <b>Purpose:</b> Synchronously loads modules<br>
                        <b>Syntax:</b> const mod = require('./file')<br>
                        <b>Cache:</b> Modules cached after first load<br>
                        <b>Resolves:</b> .js, .json, node_modules<br>
                        <b>Dynamic:</b> Can use variables in path<br>
                        <b>vs import:</b> Runtime vs compile time<br>
                        <b>Returns:</b> module.exports value`,
                    
                    'process': `<b>process</b> - Node.js Global Object<br><br>
                        <b>Purpose:</b> Info about current Node process<br>
                        <b>Properties:</b> env, argv, cwd(), pid, platform<br>
                        <b>Methods:</b> exit(), nextTick(), on()<br>
                        <b>Events:</b> uncaughtException, exit, SIGINT<br>
                        <b>Env Vars:</b> process.env.NODE_ENV<br>
                        <b>Args:</b> process.argv array<br>
                        <b>Global:</b> Available without require`,
                    
                    'document': `<b>document</b> - DOM Interface Object<br><br>
                        <b>Purpose:</b> Represents HTML/XML document<br>
                        <b>Methods:</b> getElementById, querySelector<br>
                        <b>Creates:</b> createElement, createTextNode<br>
                        <b>Properties:</b> body, head, title, cookie<br>
                        <b>Events:</b> addEventListener, removeEventListener<br>
                        <b>Example:</b> document.querySelector('.class')<br>
                        <b>Scope:</b> Browser only, not Node.js`,
                    
                    'window': `<b>window</b> - Browser Global Object<br><br>
                        <b>Purpose:</b> Browser window/tab interface<br>
                        <b>Contains:</b> document, location, history, navigator<br>
                        <b>Methods:</b> alert, confirm, open, close<br>
                        <b>Timers:</b> setTimeout, setInterval<br>
                        <b>Storage:</b> localStorage, sessionStorage<br>
                        <b>Sizing:</b> innerWidth, innerHeight<br>
                        <b>Global:</b> All globals are window properties`,
                    
                    'setTimeout': `<b>setTimeout()</b> - Delayed Execution<br><br>
                        <b>Purpose:</b> Executes function after delay<br>
                        <b>Syntax:</b> setTimeout(fn, delay, ...args)<br>
                        <b>Returns:</b> Timer ID for cancellation<br>
                        <b>Cancel:</b> clearTimeout(timerId)<br>
                        <b>Minimum:</b> ~4ms in browsers<br>
                        <b>This:</b> Use arrow functions or .bind()<br>
                        <b>Example:</b> setTimeout(() => {}, 1000)`,
                    
                    'setInterval': `<b>setInterval()</b> - Repeated Execution<br><br>
                        <b>Purpose:</b> Repeats function at intervals<br>
                        <b>Syntax:</b> setInterval(fn, delay, ...args)<br>
                        <b>Returns:</b> Interval ID for cancellation<br>
                        <b>Cancel:</b> clearInterval(intervalId)<br>
                        <b>Drift:</b> Can accumulate timing errors<br>
                        <b>Alternative:</b> Recursive setTimeout<br>
                        <b>Example:</b> setInterval(tick, 1000)`,
                    
                    'fetch': `<b>fetch()</b> - HTTP Request API<br><br>
                        <b>Purpose:</b> Modern promise-based HTTP client<br>
                        <b>Syntax:</b> fetch(url, options)<br>
                        <b>Returns:</b> Promise<Response><br>
                        <b>Methods:</b> GET, POST, PUT, DELETE<br>
                        <b>Body:</b> .json(), .text(), .blob()<br>
                        <b>Example:</b> fetch('/api').then(r => r.json())<br>
                        <b>Async:</b> const data = await fetch(url)`,
                    
                    'push': `<b>push()</b> - Array End Addition<br><br>
                        <b>Purpose:</b> Adds elements to array end<br>
                        <b>Syntax:</b> array.push(item1, item2, ...)<br>
                        <b>Returns:</b> New array length<br>
                        <b>Mutates:</b> Changes original array<br>
                        <b>Multiple:</b> Can push many at once<br>
                        <b>Performance:</b> O(1) operation<br>
                        <b>Example:</b> arr.push(1, 2, 3)`,
                    
                    'pop': `<b>pop()</b> - Array End Removal<br><br>
                        <b>Purpose:</b> Removes last array element<br>
                        <b>Syntax:</b> const last = array.pop()<br>
                        <b>Returns:</b> Removed element (or undefined)<br>
                        <b>Mutates:</b> Changes original array<br>
                        <b>Empty:</b> Returns undefined on empty<br>
                        <b>Stack:</b> With push() makes LIFO stack<br>
                        <b>Performance:</b> O(1) operation`,
                    
                    'map': `<b>map()</b> - Array Transformation<br><br>
                        <b>Purpose:</b> Creates new array by transforming each element<br>
                        <b>Syntax:</b> array.map((item, index, array) => newItem)<br>
                        <b>Returns:</b> New array (doesn't mutate)<br>
                        <b>Length:</b> Same as original<br>
                        <b>Skip:</b> Skips empty slots<br>
                        <b>Example:</b> [1,2,3].map(x => x * 2)<br>
                        <b>Chain:</b> .map().filter().reduce()`,
                    
                    'filter': `<b>filter()</b> - Array Filtering<br><br>
                        <b>Purpose:</b> Creates array with passing elements<br>
                        <b>Syntax:</b> array.filter((item, index) => boolean)<br>
                        <b>Returns:</b> New filtered array<br>
                        <b>Predicate:</b> Function returns true to keep<br>
                        <b>Immutable:</b> Doesn't change original<br>
                        <b>Example:</b> nums.filter(x => x > 0)<br>
                        <b>Empty:</b> Returns [] if none pass`,
                    
                    'reduce': `<b>reduce()</b> - Array Aggregation<br><br>
                        <b>Purpose:</b> Reduces array to single value<br>
                        <b>Syntax:</b> array.reduce((acc, cur, idx) => {}, init)<br>
                        <b>Accumulator:</b> Carries value between calls<br>
                        <b>Initial:</b> Starting value (important!)<br>
                        <b>Example:</b> [1,2,3].reduce((sum, n) => sum + n, 0)<br>
                        <b>Use:</b> Sum, flatten, group, unique<br>
                        <b>Power:</b> Can implement map/filter`,
                    
                    'forEach': `<b>forEach()</b> - Array Iteration<br><br>
                        <b>Purpose:</b> Executes function for each element<br>
                        <b>Syntax:</b> array.forEach((item, index, array) => {})<br>
                        <b>Returns:</b> undefined (always)<br>
                        <b>Break:</b> Cannot break/continue<br>
                        <b>Async:</b> Doesn't wait for promises<br>
                        <b>vs for:</b> More functional style<br>
                        <b>Side Effects:</b> For mutations, DOM, logs`,
                    
                    'find': `<b>find()</b> - Element Search<br><br>
                        <b>Purpose:</b> Returns first matching element<br>
                        <b>Syntax:</b> array.find((item) => condition)<br>
                        <b>Returns:</b> Element or undefined<br>
                        <b>Stops:</b> After first match<br>
                        <b>vs filter:</b> Single item vs array<br>
                        <b>Example:</b> users.find(u => u.id === 5)<br>
                        <b>Index:</b> Use findIndex() for position`,
                    
                    'includes': `<b>includes()</b> - Membership Test<br><br>
                        <b>Purpose:</b> Checks if array contains value<br>
                        <b>Syntax:</b> array.includes(searchElement, fromIndex)<br>
                        <b>Returns:</b> true or false<br>
                        <b>Equality:</b> Uses === comparison<br>
                        <b>NaN:</b> Correctly finds NaN<br>
                        <b>Example:</b> [1,2,3].includes(2) // true<br>
                        <b>Strings:</b> Also works on strings`,
                    
                    'join': `<b>join()</b> - Array to String<br><br>
                        <b>Purpose:</b> Concatenates array into string<br>
                        <b>Syntax:</b> array.join(separator)<br>
                        <b>Default:</b> Comma separator<br>
                        <b>Empty:</b> join('') for no separator<br>
                        <b>Example:</b> ['a','b','c'].join('-') // "a-b-c"<br>
                        <b>Opposite:</b> string.split(separator)<br>
                        <b>null/undefined:</b> Become empty strings`,
                    
                    'split': `<b>split()</b> - String to Array<br><br>
                        <b>Purpose:</b> Divides string into array<br>
                        <b>Syntax:</b> string.split(separator, limit)<br>
                        <b>Separator:</b> String or regex<br>
                        <b>Empty:</b> split('') for characters<br>
                        <b>Limit:</b> Max array length<br>
                        <b>Example:</b> 'a-b-c'.split('-') // ['a','b','c']<br>
                        <b>Regex:</b> 'a1b2c'.split(/\\d/) // ['a','b','c']`,
                    
                    'slice': `<b>slice()</b> - Extract Portion<br><br>
                        <b>Purpose:</b> Returns shallow copy of portion<br>
                        <b>Syntax:</b> array.slice(start, end)<br>
                        <b>Indexes:</b> start included, end excluded<br>
                        <b>Negative:</b> Count from end<br>
                        <b>Copy:</b> slice() copies entire array<br>
                        <b>Strings:</b> Also works on strings<br>
                        <b>Example:</b> [1,2,3,4].slice(1,3) // [2,3]`,
                    
                    'substring': `<b>substring()</b> - String Extraction<br><br>
                        <b>Purpose:</b> Extracts characters between indexes<br>
                        <b>Syntax:</b> string.substring(start, end)<br>
                        <b>vs slice:</b> No negative indexes<br>
                        <b>Swaps:</b> If start > end, swaps them<br>
                        <b>Negative:</b> Treated as 0<br>
                        <b>Example:</b> 'hello'.substring(1,4) // "ell"<br>
                        <b>Prefer:</b> slice() is more predictable`,
                    
                    'replace': `<b>replace()</b> - String Substitution<br><br>
                        <b>Purpose:</b> Replaces pattern in string<br>
                        <b>Syntax:</b> string.replace(search, replacement)<br>
                        <b>First Only:</b> Replaces first match<br>
                        <b>Global:</b> Use /g flag for all<br>
                        <b>Function:</b> Replacement can be function<br>
                        <b>Example:</b> 'aaa'.replace('a', 'b') // "baa"<br>
                        <b>All:</b> 'aaa'.replace(/a/g, 'b') // "bbb"`,
                    
                    'match': `<b>match()</b> - Pattern Matching<br><br>
                        <b>Purpose:</b> Finds regex matches in string<br>
                        <b>Syntax:</b> string.match(regexp)<br>
                        <b>Returns:</b> Array of matches or null<br>
                        <b>Global:</b> /g returns all matches<br>
                        <b>Groups:</b> Captures in result array<br>
                        <b>Example:</b> '123'.match(/\\d+/) // ['123']<br>
                        <b>No Match:</b> Returns null (check!)`,
                    
                    'test': `<b>test()</b> - Regex Test Method<br><br>
                        <b>Purpose:</b> Tests if pattern matches string<br>
                        <b>Syntax:</b> regex.test(string)<br>
                        <b>Returns:</b> true or false only<br>
                        <b>Faster:</b> Than match() for boolean<br>
                        <b>State:</b> Updates regex lastIndex<br>
                        <b>Example:</b> /\\d+/.test('abc123') // true<br>
                        <b>Note:</b> Method of RegExp, not string`
                }
            };
            
            if (type === 'keyword' && tooltips.keyword[text]) {
                return tooltips.keyword[text];
            }
            if (type === 'operator' && tooltips.operator[text]) {
                return tooltips.operator[text];
            }
            if (type === 'function' && tooltips.function[text]) {
                return tooltips.function[text];
            }
            if (type === 'string') {
                return `<b>String Literal</b> - Text Data Type<br><br>
                    <b>Quotes:</b> Single ' ', double " ", or backtick \` \`<br>
                    <b>Escaping:</b> Use backslash \\ for special chars<br>
                    <b>Template:</b> Backticks allow \${expression} interpolation<br>
                    <b>Multiline:</b> Only with backticks<br>
                    <b>Immutable:</b> Cannot change individual characters<br>
                    <b>Methods:</b> .length, .charAt(), .slice(), .split()<br>
                    <b>Unicode:</b> Full UTF-16 support`;
            }
            if (type === 'number') {
                return `<b>Numeric Literal</b> - Number Data Type<br><br>
                    <b>Types:</b> Integer, decimal, scientific notation<br>
                    <b>Range:</b> 1.7976931348623157e+308<br>
                    <b>Precision:</b> 64-bit floating point (IEEE 754)<br>
                    <b>Special:</b> Infinity, -Infinity, NaN<br>
                    <b>Binary:</b> 0b1010, Octal: 0o12, Hex: 0xA<br>
                    <b>BigInt:</b> Append n for arbitrary precision<br>
                    <b>Safe:</b> Number.MAX_SAFE_INTEGER`;
            }
            if (type === 'comment') {
                return `<b>Code Comment</b> - Documentation<br><br>
                    <b>Purpose:</b> Human-readable notes, ignored by interpreter<br>
                    <b>Single Line:</b> // comment text<br>
                    <b>Multi Line:</b> /* comment block */<br>
                    <b>JSDoc:</b> /** @param {type} name */<br>
                    <b>Best Practice:</b> Explain why, not what<br>
                    <b>Avoid:</b> Obvious comments, commented-out code<br>
                    <b>Use For:</b> Complex logic, TODOs, warnings`;
            }
            if (type === 'property') {
                return `<b>Property/Method Access</b> - Object Member<br><br>
                    <b>Dot Notation:</b> object.property<br>
                    <b>Bracket:</b> object['property'] for dynamic<br>
                    <b>Method:</b> If property is function<br>
                    <b>Chain:</b> object.prop1.prop2.method()<br>
                    <b>Optional:</b> object?.property (safe access)<br>
                    <b>This:</b> In methods, refers to object<br>
                    <b>Inherited:</b> May come from prototype chain`;
            }
            if (type === 'punctuation') {
                const punctuationTooltips = {
                    '{': `<b>{</b> - Opening Brace<br><br>
                        <b>Block:</b> Starts code block for functions, loops, conditions<br>
                        <b>Object:</b> Begins object literal definition<br>
                        <b>Destructuring:</b> {a, b} = object<br>
                        <b>Import:</b> import {named} from 'module'<br>
                        <b>Scope:</b> Creates new block scope<br>
                        <b>JSX:</b> {expression} in React<br>
                        <b>Template:</b> \${expr} in template literals`,
                    
                    '}': `<b>}</b> - Closing Brace<br><br>
                        <b>Block End:</b> Closes code blocks<br>
                        <b>Object End:</b> Completes object literal<br>
                        <b>Scope End:</b> Variables go out of scope<br>
                        <b>Pairs With:</b> Opening brace {<br>
                        <b>Style:</b> Same line or new line debates<br>
                        <b>Error:</b> "Unexpected token }" if mismatched<br>
                        <b>Trailing:</b> Comma before } is allowed`,
                    
                    '(': `<b>(</b> - Opening Parenthesis<br><br>
                        <b>Function:</b> Starts parameter list or call<br>
                        <b>Expression:</b> Groups operations (a + b) * c<br>
                        <b>Condition:</b> if (condition), while (test)<br>
                        <b>IIFE:</b> (function() {})() pattern<br>
                        <b>Arrow:</b> (x, y) => x + y<br>
                        <b>Precedence:</b> Overrides operator order<br>
                        <b>Destructure:</b> ({a, b}) in parameters`,
                    
                    ')': `<b>)</b> - Closing Parenthesis<br><br>
                        <b>Function End:</b> Completes parameters/calls<br>
                        <b>Expression End:</b> Closes grouped operations<br>
                        <b>Balance:</b> Must match opening (<br>
                        <b>Empty:</b> () for no parameters<br>
                        <b>Invoke:</b> fn() executes function<br>
                        <b>Error:</b> Common source of syntax errors<br>
                        <b>Chain:</b> method1().method2()`,
                    
                    '[': `<b>[</b> - Opening Bracket<br><br>
                        <b>Array:</b> Starts array literal [1, 2, 3]<br>
                        <b>Index:</b> Access array[0] or object['key']<br>
                        <b>Destructure:</b> [a, b] = array<br>
                        <b>Computed:</b> {[key]: value} properties<br>
                        <b>Spread:</b> [...array] expansion<br>
                        <b>Optional:</b> obj?.[expr] chaining<br>
                        <b>Regex:</b> Character class [a-z]`,
                    
                    ']': `<b>]</b> - Closing Bracket<br><br>
                        <b>Array End:</b> Completes array literal<br>
                        <b>Index End:</b> Closes property/index access<br>
                        <b>Empty:</b> [] creates empty array<br>
                        <b>Nested:</b> array[0][1] for 2D arrays<br>
                        <b>Length:</b> array[array.length - 1]<br>
                        <b>Slice:</b> array[start:end] in Python<br>
                        <b>Type:</b> TypeScript number[] syntax`,
                    
                    ';': `<b>;</b> - Semicolon Statement Terminator<br><br>
                        <b>Purpose:</b> Explicitly ends statements<br>
                        <b>ASI:</b> Automatic Semicolon Insertion<br>
                        <b>Required:</b> for(;;) loops, same-line statements<br>
                        <b>Style:</b> Optional but recommended<br>
                        <b>Gotcha:</b> return\\n value returns undefined<br>
                        <b>IIFE:</b> ;(function(){})() defensive<br>
                        <b>Minification:</b> Required for safe minification`,
                    
                    ',': `<b>,</b> - Comma Separator<br><br>
                        <b>Lists:</b> Separates array/object items<br>
                        <b>Parameters:</b> function(a, b, c)<br>
                        <b>Destructuring:</b> {a, b} or [x, y]<br>
                        <b>Multiple:</b> let a = 1, b = 2;<br>
                        <b>Trailing:</b> [1, 2,] allowed in ES5+<br>
                        <b>Operator:</b> (a, b) evaluates both, returns b<br>
                        <b>Skip:</b> [a, , c] skips middle element`,
                    
                    '.': `<b>.</b> - Dot Property Accessor<br><br>
                        <b>Access:</b> object.property notation<br>
                        <b>Chain:</b> obj.prop1.prop2.method()<br>
                        <b>Number:</b> 3.14 decimal point<br>
                        <b>Spread:</b> ...array or ...object<br>
                        <b>Optional:</b> obj?.prop safe access<br>
                        <b>Static:</b> Class.staticMethod()<br>
                        <b>Precedence:</b> Very high (left-to-right)`,
                    
                    ':': `<b>:</b> - Colon Multiple Uses<br><br>
                        <b>Object:</b> {key: value} property separator<br>
                        <b>Ternary:</b> condition ? true : false<br>
                        <b>Label:</b> labelName: statement<br>
                        <b>Switch:</b> case value: statements<br>
                        <b>Type:</b> TypeScript let x: number<br>
                        <b>Destructure:</b> {a: newName} rename<br>
                        <b>Time:</b> "12:30:45" in strings`
                };
                return punctuationTooltips[text] || null;
            }
            
            return null;
        }
        
        // Highlight code with syntax colors
        function highlightCode(code) {
            // Simple tokenizer for demonstration
            const tokens = [];
            const patterns = [
                // Strings
                { regex: /(["'`])(?:(?=(\\?))\2[\s\S])*?\1/g, type: 'string' },
                // Comments
                { regex: /\/\/.*$/gm, type: 'comment' },
                { regex: /\/\*[\s\S]*?\*\//g, type: 'comment' },
                // Numbers
                { regex: /\b\d+\.?\d*\b/g, type: 'number' },
                // Keywords and special words
                { regex: /\b(const|let|var|function|async|await|class|interface|import|export|return|if|else|for|while|try|catch|throw|new|this|super|extends|implements|typeof|instanceof|in|of|true|false|null|undefined|void|string|number|boolean|any)\b/g, type: 'keyword' },
                // Functions and methods
                { regex: /\b([a-zA-Z_$][a-zA-Z0-9_$]*)\s*(?=\()/g, type: 'function' },
                // Properties
                { regex: /\.([a-zA-Z_$][a-zA-Z0-9_$]*)/g, type: 'property' },
                // Operators
                { regex: /(=>|===|!==|==|!=|<=|>=|<|>|\+\+|--|&&|\|\||!|\+|-|\*|\/|%|=|\+=|-=|\*=|\/=|\.\.\.|\?\.|\?\?)/g, type: 'operator' },
                // Punctuation
                { regex: /[{}()\[\];,.:]/g, type: 'punctuation' }
            ];
            
            // Create a map of all matches
            const matches = [];
            patterns.forEach(pattern => {
                let match;
                const regex = new RegExp(pattern.regex);
                while ((match = regex.exec(code)) !== null) {
                    matches.push({
                        start: match.index,
                        end: match.index + match[0].length,
                        text: match[0],
                        type: pattern.type,
                        captured: match[1] || match[0]
                    });
                }
            });
            
            // Sort by position
            matches.sort((a, b) => a.start - b.start);
            
            // Remove overlapping matches (keep first)
            const finalMatches = [];
            let lastEnd = 0;
            matches.forEach(match => {
                if (match.start >= lastEnd) {
                    finalMatches.push(match);
                    lastEnd = match.end;
                }
            });
            
            // Build highlighted code
            let result = '';
            let position = 0;
            
            finalMatches.forEach(match => {
                // Add unhighlighted text before match
                if (position < match.start) {
                    result += escapeHtml(code.substring(position, match.start));
                }
                
                // Add highlighted match with tooltip
                const tooltipText = getTooltipForCode(match.type, match.text);
                if (tooltipText) {
                    result += `<span class="code-${match.type}" data-tooltip="${tooltipText}">${escapeHtml(match.text)}</span>`;
                } else {
                    result += `<span class="code-${match.type}">${escapeHtml(match.text)}</span>`;
                }
                
                position = match.end;
            });
            
            // Add remaining text
            if (position < code.length) {
                result += escapeHtml(code.substring(position));
            }
            
            return result;
        }
        
        
        // Helper function to escape HTML
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }
        
        // Simple tooltip implementation
        let tooltip = null;
        
        function createTooltip() {
            tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            document.body.appendChild(tooltip);
        }
        
        function showTooltip(e) {
            if (!tooltip) createTooltip();
            
            const tooltipText = e.target.getAttribute('data-tooltip');
            if (!tooltipText) return;
            
            tooltip.innerHTML = tooltipText;
            tooltip.style.opacity = '1';
            
            // Position tooltip above cursor
            const x = e.clientX;
            const y = e.clientY;
            
            // Get tooltip dimensions
            const rect = tooltip.getBoundingClientRect();
            
            // Center tooltip horizontally on cursor
            tooltip.style.left = `${x - rect.width / 2}px`;
            
            // Position above cursor
            tooltip.style.top = `${y - rect.height - 10}px`;
            
            // Keep tooltip within viewport
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            
            // Adjust horizontal position if needed
            if (rect.left < 0) {
                tooltip.style.left = '10px';
            } else if (rect.right > viewportWidth) {
                tooltip.style.left = `${viewportWidth - rect.width - 10}px`;
            }
            
            // Flip to below cursor if too close to top
            if (y - rect.height - 10 < 0) {
                tooltip.style.top = `${y + 10}px`;
            }
        }
        
        function hideTooltip() {
            if (tooltip) {
                tooltip.style.opacity = '0';
            }
        }
        
        // Use event delegation for better performance
        document.addEventListener('mouseover', (e) => {
            if (e.target.hasAttribute('data-tooltip')) {
                showTooltip(e);
            }
        });
        
        document.addEventListener('mousemove', (e) => {
            if (e.target.hasAttribute('data-tooltip')) {
                showTooltip(e);
            }
        });
        
        document.addEventListener('mouseout', (e) => {
            if (e.target.hasAttribute('data-tooltip')) {
                hideTooltip();
            }
        });
        
        // Load content on page load
        loadMarkdown();
    </script>
</body>
</html>